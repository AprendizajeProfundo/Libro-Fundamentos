
<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Introducción a Modelos Secuenciales &#8212; Fundamentos de IA y AP</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Introducción a Redes Neuronales Recurrentes" href="rnn_Intro_Redes_Recurrentes.html" />
    <link rel="prev" title="Visualización del Entrenamiento de una Red Neuronal" href="../../Redes_Neuronales/Cuadernos/NN_Animation2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="es">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo-final-ap.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Fundamentos de IA y AP</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../tutorial.html">
                    <span style="color:#F72585">Bienvenido(a)</span>
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Conociendo el libro
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Inicio/Cuadernos/Consideraciones.html">
   <span style="color:#F72585">
    Conociendo el Libro
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fundamentos de Estadística
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Conceptos_Basicos.html">
   <span style="color:#F72585">
    Probabilidad
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Variables_Aleatorias.html">
   <span style="color:#F72585">
    Variables Aleatorias
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Var_Prob_conjunta.html">
   <span style="color:#F72585">
    Probabilidad Conjunta y Entropía Cruzada
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Distribuciones_continuas.html">
   <span style="color:#F72585">
    Distribuciones de probabilidad continuas
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Regresi%C3%B3n-Lineal-Pyton-Copy1.html">
   <span style="color:#F72585">
    Regresión Lineal en Python
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Teoría de la Información
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/ti_Teoria_Informacion.html">
   <span style="color:#F72585">
    Teoría de la Información
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Álgebra Lineal
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Intro_Tensores_I.html">
   <span style="color:#F72585">
    Introducción a tensores
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Intro_Tensores_II.html">
   <span style="color:#F72585">
    Tensores
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Tensor_Distribucion_Prob.html">
   <span style="color:#F72585">
    Tensores y distribuciones de probabilidad
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modelación
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/mod_Modelamiento.html">
   <span style="color:#F72585">
    Ejemplos de Modelos
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/mod_Ejemplo_Modelamiento.html">
   <span style="color:#F72585">
    Ejemplos de Modelamiento
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/cal_derivadas.html">
   <span style="color:#F72585">
    Introducción a la Derivación
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Optimization_1.html">
   <span style="color:#F72585">
    Optimización univariada usando JAX
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Optimization_2.html">
   <span style="color:#F72585">
    Optimización multivariada usando JAX
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/am-sdg.html">
   <span style="color:#F72585">
    Optimización
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Aprendizaje de máquinas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/am_intro_aprendizaje_maquinas.html">
   <span style="color:#F72585">
    Conceptos básicos de aprendizaje de máquinas
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/am_Regresion_logistica_JAX.html">
   <span style="color:#F72585">
    Modelo Lineal de Clasificación  con JAX
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/am_Regresion_Logistica_Tensorflow.html">
   <span style="color:#F72585">
    Modelo Logístico de Clasificación  con Tensorflow 2.X
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/am_regresion_Keras.html">
   <span style="color:#F72585">
    Regresion Basica con tf.keras: Predecir eficiencia de la gasolina
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/am-logistico-keras-cancer.html">
   <span style="color:#F72585">
    Modelo logístico de predicción en tf.keras
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Aprendizaje de máquinas no supervisado
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/BreveIntroduccion2R.html">
   <span style="color:#F72585">
    Breve introducción a R
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/AprendizajeNoSupervisado.html">
   <span style="color:#F72585">
    Aprendizaje no supervisado
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/ACP.html">
   <span style="color:#F72585">
    Análisis en componentes principales
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/ACS.html">
   <span style="color:#F72585">
    Análisis de correspondencias simples
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/ACM.html">
   <span style="color:#F72585">
    Análisis de correspondencias múltiples (ACM)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/Agrupamiento.html">
   <span style="color:#F72585">
    Algunos métodos de clasificación no supervisada (agrupamiento)
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Mapas auto-organizados (SOM)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/som_Introduccion.html">
   <span style="color:#F72585">
    Mapas Auto-organizados (SOM)
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Redes Neuronales
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/RedesNeuronales_intro.html">
   <span style="color:#F72585">
    Introducción a Redes Neuronales
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Activation_Functions.html">
   <span style="color:#F72585">
    Funciones de Activación
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Hello_World_ML.html">
   <span style="color:#F72585">
    Introducción a Keras Sequential y API Funcional
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Intro_Keras_Sequential.html">
   <span style="color:#F72585">
    Introducción a la API Sequential de Keras
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Intro_Keras_Functional.html">
   <span style="color:#F72585">
    Introducción a la API funcional de Keras
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/am-softmax-keras-iris.html">
   <span style="color:#F72585">
    Clasificación, Softmax, Iris
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/am_regresion_Keras_gasolina.html">
   <span style="color:#F72585">
    Regresion Basica con tf.keras: Predecir eficiencia de la gasolina
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/am-subclassing-iris.html">
   <span style="color:#F72585">
    Subclassing-Modelo de Regresión multi-logística
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/NN_Animation2.html">
   <span style="color:#F72585">
    Visualización del Entrenamiento de una Red Neuronal
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Redes Recurrentes
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   <span style="color:#F72585">
    Introducción a Modelos Secuenciales
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rnn_Intro_Redes_Recurrentes.html">
   <span style="color:#F72585">
    Introducción a Redes Neuronales Recurrentes
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rnr_LSTM_Intro.html">
   <span style="color:#F72585">
    Redes LSTM (Long Short Term Memory Networks)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rnr_GRU_Intro.html">
   <span style="color:#F72585">
    Redes GRU (Gated Recurrent Unit)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rnr_Times_series_Intro-lstm.html">
   <span style="color:#F72585">
    Ejemplo 1: Serie de tiempo simulada
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rnr_accion_Apple_Prediccion_un_dia-dropout.html">
   <span style="color:#F72585">
    Predicción del valor de una acción a un día. Apple (LSTM)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rnr_accion_Apple_Prediccion_tres_dias-dropout.html">
   <span style="color:#F72585">
    Predicción del valor de una acción a tres días. Apple (LSTM)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rnr_accion_Apple_Prediccion_tres_dias-multiple.html">
   <span style="color:#F72585">
    Predicción de secuencia de valores futuros de una acción. Apple (LSTM)
   </span>
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/AprendizajeProfundo/Libro-Fundamentos/main?urlpath=tree/Redes_Recurrentes/Cuadernos/rnr_Times_series_Intro.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/AprendizajeProfundo/Libro-Fundamentos/blob/main/Redes_Recurrentes/Cuadernos/rnr_Times_series_Intro.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/AprendizajeProfundo/Libro-Fundamentos"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/AprendizajeProfundo/Libro-Fundamentos/issues/new?title=Issue%20on%20page%20%2FRedes_Recurrentes/Cuadernos/rnr_Times_series_Intro.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/AprendizajeProfundo/Libro-Fundamentos/edit/main/Redes_Recurrentes/Cuadernos/rnr_Times_series_Intro.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/Redes_Recurrentes/Cuadernos/rnr_Times_series_Intro.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-herramientas-basicas-de-programacion-span">
   <span style="color:#4361EE">
    Herramientas básicas de programación
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-importa-modulos-span">
     <span style="color:#4CC9F0">
      Importa módulos
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-clase-acumulador-para-evaluar-funciones-de-perdida-span">
     <span style="color:#4CC9F0">
      Clase Acumulador para evaluar funciones de pérdida
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-utilitarios-para-preparar-datos-en-tensorflow-span">
     <span style="color:#4CC9F0">
      Utilitarios para preparar  datos en Tensorflow
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-funcion-generica-para-calcular-funciones-de-perdida-span">
     <span style="color:#4CC9F0">
      Función genérica para calcular funciones de pérdida
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-funciones-graficas-utilitarias-span">
     <span style="color:#4CC9F0">
      Funciones gráficas utilitarias
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-introduccion-span">
   <span style="color:#4361EE">
    Introducción
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-herramientas-estadisticas-span">
   <span style="color:#4361EE">
    Herramientas estadísticas
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-modelos-autorregresivos-span">
     <span style="color:#4CC9F0">
      Modelos Autorregresivos
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-modelos-de-markov-span">
     <span style="color:#4CC9F0">
      Modelos de Markov
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-causalidad-span">
     <span style="color:#4CC9F0">
      Causalidad
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-entrenamiento-span">
   <span style="color:#4361EE">
    Entrenamiento
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-generacion-de-datos-simulados-datos-sinteticos-span">
     <span style="color:#4CC9F0">
      Generación de datos simulados (datos sintéticos)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-define-la-red-vainilla-que-usaremos-span">
     <span style="color:#4CC9F0">
      Define la red Vainilla que usaremos
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-define-la-funcion-de-perdida-span">
     <span style="color:#4CC9F0">
      Define la función de pérdida
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-entrenamiento-span">
     <span style="color:#4CC9F0">
      Entrenamiento
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-prediccion-span">
   <span style="color:#4361EE">
    Predicción
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-resumen-span">
   <span style="color:#4361EE">
    Resumen
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-referencias-span">
   <span style="color:#4361EE">
    Referencias
   </span>
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1><span style="color:#F72585">Introducción a Modelos Secuenciales</span></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-herramientas-basicas-de-programacion-span">
   <span style="color:#4361EE">
    Herramientas básicas de programación
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-importa-modulos-span">
     <span style="color:#4CC9F0">
      Importa módulos
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-clase-acumulador-para-evaluar-funciones-de-perdida-span">
     <span style="color:#4CC9F0">
      Clase Acumulador para evaluar funciones de pérdida
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-utilitarios-para-preparar-datos-en-tensorflow-span">
     <span style="color:#4CC9F0">
      Utilitarios para preparar  datos en Tensorflow
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-funcion-generica-para-calcular-funciones-de-perdida-span">
     <span style="color:#4CC9F0">
      Función genérica para calcular funciones de pérdida
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-funciones-graficas-utilitarias-span">
     <span style="color:#4CC9F0">
      Funciones gráficas utilitarias
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-introduccion-span">
   <span style="color:#4361EE">
    Introducción
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-herramientas-estadisticas-span">
   <span style="color:#4361EE">
    Herramientas estadísticas
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-modelos-autorregresivos-span">
     <span style="color:#4CC9F0">
      Modelos Autorregresivos
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-modelos-de-markov-span">
     <span style="color:#4CC9F0">
      Modelos de Markov
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-causalidad-span">
     <span style="color:#4CC9F0">
      Causalidad
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-entrenamiento-span">
   <span style="color:#4361EE">
    Entrenamiento
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-generacion-de-datos-simulados-datos-sinteticos-span">
     <span style="color:#4CC9F0">
      Generación de datos simulados (datos sintéticos)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-define-la-red-vainilla-que-usaremos-span">
     <span style="color:#4CC9F0">
      Define la red Vainilla que usaremos
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-define-la-funcion-de-perdida-span">
     <span style="color:#4CC9F0">
      Define la función de pérdida
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-entrenamiento-span">
     <span style="color:#4CC9F0">
      Entrenamiento
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-prediccion-span">
   <span style="color:#4361EE">
    Predicción
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-resumen-span">
   <span style="color:#4361EE">
    Resumen
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-referencias-span">
   <span style="color:#4361EE">
    Referencias
   </span>
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="span-style-color-f72585-introduccion-a-modelos-secuenciales-span">
<h1><span style="color:#F72585">Introducción a Modelos Secuenciales</span><a class="headerlink" href="#span-style-color-f72585-introduccion-a-modelos-secuenciales-span" title="Enlazar permanentemente con este título">#</a></h1>
<section id="span-style-color-4361ee-herramientas-basicas-de-programacion-span">
<h2><span style="color:#4361EE">Herramientas básicas de programación</span><a class="headerlink" href="#span-style-color-4361ee-herramientas-basicas-de-programacion-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>Adaptadas del texto <a class="reference external" href="https://d2l.ai/">Dive into Deep learning</a>.</p>
<section id="span-style-color-4cc9f0-importa-modulos-span">
<h3><span style="color:#4CC9F0">Importa módulos</span><a class="headerlink" href="#span-style-color-4cc9f0-importa-modulos-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#import collections</span>
<span class="c1">#from collections import defaultdict</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="c1">#import re</span>
<span class="c1">#import shutil</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="c1">#import tarfile</span>
<span class="c1">#import time</span>
<span class="c1">#import requests</span>
<span class="c1">#import zipfile</span>
<span class="c1">#import hashlib</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Alias</span>
<span class="n">size</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-4cc9f0-clase-acumulador-para-evaluar-funciones-de-perdida-span">
<h3><span style="color:#4CC9F0">Clase Acumulador para evaluar funciones de pérdida</span><a class="headerlink" href="#span-style-color-4cc9f0-clase-acumulador-para-evaluar-funciones-de-perdida-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Accumulator</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;For accumulating sums over `n` variables.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-4cc9f0-utilitarios-para-preparar-datos-en-tensorflow-span">
<h3><span style="color:#4CC9F0">Utilitarios para preparar  datos en Tensorflow</span><a class="headerlink" href="#span-style-color-4cc9f0-utilitarios-para-preparar-datos-en-tensorflow-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    
<span class="k">def</span> <span class="nf">load_array</span><span class="p">(</span><span class="n">data_arrays</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">is_train</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct a TensorFlow data iterator.&quot;&quot;&quot;</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">(</span><span class="n">data_arrays</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_train</span><span class="p">:</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">buffer_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dataset</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-4cc9f0-funcion-generica-para-calcular-funciones-de-perdida-span">
<h3><span style="color:#4CC9F0">Función genérica para calcular funciones de pérdida</span><a class="headerlink" href="#span-style-color-4cc9f0-funcion-generica-para-calcular-funciones-de-perdida-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_loss</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">data_iter</span><span class="p">,</span> <span class="n">loss</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Evaluate the loss of a model on the given dataset.&quot;&quot;&quot;</span>
    <span class="n">metric</span> <span class="o">=</span> <span class="n">Accumulator</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Sum of losses, no. of examples</span>
    <span class="k">for</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">data_iter</span><span class="p">:</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">metric</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">size</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">metric</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">metric</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-4cc9f0-funciones-graficas-utilitarias-span">
<h3><span style="color:#4CC9F0">Funciones gráficas utilitarias</span><a class="headerlink" href="#span-style-color-4cc9f0-funciones-graficas-utilitarias-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>


<span class="c1"># Defined in file: ./chapter_preliminaries/calculus.md</span>
<span class="k">def</span> <span class="nf">use_svg_display</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Use the svg format to display a plot in Jupyter.&quot;&quot;&quot;</span>
    <span class="n">display</span><span class="o">.</span><span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>


<span class="c1"># Defined in file: ./chapter_preliminaries/calculus.md</span>
<span class="k">def</span> <span class="nf">set_figsize</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;Set the figure size for matplotlib.&quot;&quot;&quot;</span>
    <span class="n">use_svg_display</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">figsize</span>


<span class="c1"># </span>
<span class="k">def</span> <span class="nf">set_axes</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span><span class="p">,</span> <span class="n">legend</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the axes for matplotlib.&quot;&quot;&quot;</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>


<span class="c1"># </span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
         <span class="n">fmts</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;m--&#39;</span><span class="p">,</span> <span class="s1">&#39;g-.&#39;</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot data points.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">legend</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">set_figsize</span><span class="p">(</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="k">if</span> <span class="n">axes</span> <span class="k">else</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="c1"># Return True if `X` (tensor or list) has 1 axis</span>
    <span class="k">def</span> <span class="nf">has_one_axis</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s2">&quot;ndim&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;__len__&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">has_one_axis</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">Y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">X</span>
    <span class="k">elif</span> <span class="n">has_one_axis</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">Y</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">fmts</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
    <span class="n">set_axes</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span><span class="p">,</span> <span class="n">legend</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="span-style-color-4361ee-introduccion-span">
<h2><span style="color:#4361EE">Introducción</span><a class="headerlink" href="#span-style-color-4361ee-introduccion-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>Los datos de la serie temporal introducen una «dependencia dura» de los pasos de tiempo anteriores, por lo que no se cumple la independencia de las observaciones. Podemos entonces preguntarnos ¿Cuáles son algunas de las propiedades que puede tener una serie temporal?</p>
<p>La <em>estacionalidad</em> y la <em>auto-correlación</em> son algunas de las propiedades de la serie temporal en las que puede estar interesado.
Se dice que una serie de tiempos es <strong>estacionaria</strong> cuando la media y la varianza permanecen constantes en el tiempo. Una serie temporal tiene una <strong>tendencia</strong> si la media varía con el tiempo. A menudo es posible eliminar la tendencia y hacer que la serie sea estacionaria aplicando transformación(es) logarítmicas de los datos.</p>
<p><strong>La estacionalidad</strong> se refiere al fenómeno de las variaciones en plazos específicos. Por ejemplo, las personas  compran más árboles de Navidad durante Navidad (quién lo hubiera pensado). Un enfoque común para eliminar la estacionalidad es usar la diferenciación. <strong>La auto-correlación</strong> se refiere a la correlación entre el valor actual con una copia de un tiempo anterior (retraso).</p>
<p>En este tratado usaremos redes neuronales para la modelación de las series.</p>
</section>
<section id="span-style-color-4361ee-herramientas-estadisticas-span">
<h2><span style="color:#4361EE">Herramientas estadísticas</span><a class="headerlink" href="#span-style-color-4361ee-herramientas-estadisticas-span" title="Enlazar permanentemente con este título">#</a></h2>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Redes_Recurrentes/Imagenes/ftse100.png" width="500" height="500" align="right"/>
</center>
</figure>
<p>Necesitamos herramientas estadísticas y nuevas arquitecturas de redes neuronales profundas para manejar datos de secuencia. Para simplificar las cosas, usamos el precio de las acciones (índice FTSE 100) ilustrado en la siguiente figura.</p>
<p>Denotemos los precios por <span class="math notranslate nohighlight">\( x_t \)</span>, es decir, en el <em>tiempo</em> <span class="math notranslate nohighlight">\( t \in \mathbb{Z}^+\)</span> observamos el precio <span class="math notranslate nohighlight">\( x_t \)</span>.
Tenga en cuenta que para las secuencias de texto, <span class="math notranslate nohighlight">\( t \)</span> normalmente será discreto y variará en el conjunto de los números enteros o en subconjunto de este. Supongamos que deseamos predecir el precio de la acción para el día <span class="math notranslate nohighlight">\( t \)</span> mediante <span class="math notranslate nohighlight">\( x_t \)</span> a través de</p>
<div class="math notranslate nohighlight">
\[ x_t \sim P (x_t \mid x_ {t-1}, \ldots, x_1). \]</div>
<section id="span-style-color-4cc9f0-modelos-autorregresivos-span">
<h3><span style="color:#4CC9F0">Modelos Autorregresivos</span><a class="headerlink" href="#span-style-color-4cc9f0-modelos-autorregresivos-span" title="Enlazar permanentemente con este título">#</a></h3>
<p>Para lograr esto, podríamos usar un modelo de regresión como los que entrenamos previamente. Recuerde el ejemplo de predicción de consumo de gasolina o la tarea de predicción del valor de las casas de  Boston. Solo hay un problema importante: el número de entradas, <span class="math notranslate nohighlight">\( x_{t-1}, \ldots, x_1 \)</span> varía, dependiendo de <span class="math notranslate nohighlight">\( t \)</span>. Es decir, el número aumenta con la cantidad de datos que encontramos, y necesitaremos una aproximación para que esto sea computacionalmente manejable.</p>
<p>Gran parte de lo que sigue en esta introducción a redes recurrentes girará en torno a cómo estimar <span class="math notranslate nohighlight">\( P (x_t \mid x_{t-1}, \ldots, x_1) \)</span> de manera eficiente. En pocas palabras, nuestras estrategias se reducen a dos técnicas de la siguiente manera.</p>
<p>Primero, suponga que la secuencia potencialmente bastante larga <span class="math notranslate nohighlight">\( x_{t-1}, \ldots, x_1 \)</span> no es realmente necesaria. En este caso, podríamos contentarnos con un período de tiempo de longitud <span class="math notranslate nohighlight">\( \tau \)</span> y solo usar observaciones <span class="math notranslate nohighlight">\( x_{t-1}, \ldots, x_ {t- \tau} \)</span>.</p>
<p>El beneficio inmediato es que ahora el número de argumentos es siempre el mismo, al menos para <span class="math notranslate nohighlight">\( t&gt; \tau \)</span>. Esto nos permite entrenar una red profunda usando un modelo de regresión, en el cual se hace una regresión con los datos <span class="math notranslate nohighlight">\( x_{t-1}, \ldots, x_ {t- \tau}\)</span> para <em>predecir</em> <span class="math notranslate nohighlight">\(x_t\)</span>  . Dichos modelos se denominarán <em>modelos autorregresivos</em>, ya que literalmente realizan regresiones sobre sí mismos.</p>
<p>Para ilustrarlo, supongamos que tenemos la siguiente serie de datos</p>
<div class="math notranslate nohighlight">
\[[3.0, 2.1, 5.6, 4.2, 3.3, 4.2, 8.8, 4.5, 2.3, 5.1],\]</div>
<p>y definamos <span class="math notranslate nohighlight">\( \tau =3\)</span>. Entonces el modelo de tipo auto-regresivo se vería como sique:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(x_1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_2\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_3\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(y\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>3.0</p></td>
<td><p>2.1</p></td>
<td><p>5.6</p></td>
<td><p>4.2</p></td>
</tr>
<tr class="row-odd"><td><p>2.1</p></td>
<td><p>5.6</p></td>
<td><p>4.2</p></td>
<td><p>3.3</p></td>
</tr>
<tr class="row-even"><td><p>5.6</p></td>
<td><p>4.2</p></td>
<td><p>3.3</p></td>
<td><p>4.2</p></td>
</tr>
<tr class="row-odd"><td><p>4.2</p></td>
<td><p>3.3</p></td>
<td><p>4.2</p></td>
<td><p>8.8</p></td>
</tr>
<tr class="row-even"><td><p>3.3</p></td>
<td><p>4.2</p></td>
<td><p>8.8</p></td>
<td><p>4.2</p></td>
</tr>
<tr class="row-odd"><td><p>4.2</p></td>
<td><p>8.8</p></td>
<td><p>4.5</p></td>
<td><p>2.3</p></td>
</tr>
<tr class="row-even"><td><p>8.8</p></td>
<td><p>4.5</p></td>
<td><p>2.3</p></td>
<td><p>5.1</p></td>
</tr>
</tbody>
</table>
<p>La segunda estrategia, que se muestra en la siguiente figura, es mantener un resumen <span class="math notranslate nohighlight">\(h_t\)</span> de las observaciones pasadas y, al mismo tiempo, actualizar <span class="math notranslate nohighlight">\(h_t\)</span> además de la predicción <span class="math notranslate nohighlight">\( \hat{x}_t \)</span>.
Esto conduce a modelos que estiman <span class="math notranslate nohighlight">\( x_t \)</span> con <span class="math notranslate nohighlight">\( \hat{x}_t = P (x_{t-1} \mid h_{t}) \)</span> y además actualizaciones de la forma <span class="math notranslate nohighlight">\( h_t = g (h_{t-1}, x_{t -1}) \)</span>. Dado que <span class="math notranslate nohighlight">\( h_t \)</span> nunca se observa, estos modelos también se denominan <em>modelos autorregresivos latentes</em>.</p>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Redes_Recurrentes/Imagenes/sequence-model.svg" width="300" height="300" align="right"/>
</center>
</figure>
<p>Fuente: <a class="reference external" href="https://d2l.ai/">Dive into Deep learning</a></p>
<p>Ambos casos plantean la pregunta obvia de cómo generar datos de entrenamiento. Por lo general, se utilizan observaciones históricas para predecir la siguiente observación, dadas las que se han realizado hasta ahora. Evidentemente, no esperamos que el tiempo se detenga. Sin embargo, una suposición común es que si bien los valores específicos de <span class="math notranslate nohighlight">\( x_t \)</span> pueden cambiar, al menos la dinámica de la secuencia en sí no lo hará. Esto es razonable, ya que las dinámicas novedosas son solo eso, novedosas y, por lo tanto, no predecibles usando los datos que tenemos hasta ahora.</p>
<p>Los estadísticos llaman a las dinámicas que no cambian <em>estacionarias</em>.
Independientemente de lo que hagamos, obtendremos una estimación de toda la secuencia a través de</p>
<p>$<span class="math notranslate nohighlight">\( 
P (x_1, \ldots, x_T) = \prod_ {t = 1} ^ T P (x_t \mid x_ {t-1},  \ldots, x_1)
\)</span>$ .</p>
<p>Tenga en cuenta que las consideraciones anteriores siguen siendo válidas si tratamos con objetos discretos, como palabras, en lugar de números continuos. La única diferencia es que en tal situación necesitamos usar un clasificador en lugar de un modelo de regresión para estimar <span class="math notranslate nohighlight">\( P (x_t \mid x_{t-1}, \ldots, x_1) \)</span>.</p>
</section>
<section id="span-style-color-4cc9f0-modelos-de-markov-span">
<h3><span style="color:#4CC9F0">Modelos de Markov</span><a class="headerlink" href="#span-style-color-4cc9f0-modelos-de-markov-span" title="Enlazar permanentemente con este título">#</a></h3>
<p>Recuerde la aproximación de que en un modelo autorregresivo usamos solo <span class="math notranslate nohighlight">\( x_ {t-1}, \ldots, x_ {t- \tau} \)</span> en lugar de <span class="math notranslate nohighlight">\( x_ {t-1}, \ldots, x_1 \)</span> para estimar <span class="math notranslate nohighlight">\( x_t \)</span> . Siempre que esta aproximación sea precisa, decimos que la secuencia satisface una <em>condición de Markov</em>. En particular, si <span class="math notranslate nohighlight">\(\tau = 1\)</span>, tenemos un <em>modelo de Markov de primer orden</em> y <span class="math notranslate nohighlight">\( P (x) \)</span> viene dado por</p>
<div class="math notranslate nohighlight">
\[ P (x_1, \ldots, x_T) = \prod_ {t = 1} ^ TP (x_t \mid x_ {t-1}). \]</div>
<p>en donde <span class="math notranslate nohighlight">\(P (x_1 \mid x_0) = P (x_1)\)</span>.</p>
<p>Tales modelos son particularmente agradables siempre que <span class="math notranslate nohighlight">\( x_t \)</span> asume solo un valor discreto, ya que en este caso la programación dinámica se puede usar para calcular valores a lo largo de la cadena exactamente.</p>
<p>Por ejemplo, podemos calcular <span class="math notranslate nohighlight">\( P (x_{t + 1} \mid x_ {t-1}) \)</span> de manera eficiente:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align*}
P (x_{t + 1} \mid x_{t-1})
&amp; = \frac {\sum_{x_t} P (x_{t + 1}, x_t, x_{t-1})} {P (x_{t-1})} \\
&amp; = \frac{\sum_{x_t} P (x_{t + 1} \mid x_t, x_{t-1}) P (x_t, x_{t-1})} {P (x_{t-1} )} \\
&amp; = \sum_ {x_t} P (x_{t + 1} \mid x_t) P (x_t \mid x_{t-1}).
\end {align*}
\end{split}\]</div>
<p>En la última ecuación hemos utilizado el hecho de que solo necesitamos tener en cuenta un historial  de la observación anterior, es decir,  <span class="math notranslate nohighlight">\( P (x_{t + 1} \mid x_t, x_{t-1}) = P (x_{t + 1} \mid x_t) \)</span>.</p>
<p>Estas últimas ecuaciones se conocen como ecuaciones de <code class="docutils literal notranslate"><span class="pre">Chapman-Kolmogorov</span></code>.</p>
<p>Entrar en detalles de la programación dinámica está más allá del alcance de este documento. Los algoritmos de control y aprendizaje por refuerzo utilizan estas herramientas de forma extensiva.</p>
</section>
<section id="span-style-color-4cc9f0-causalidad-span">
<h3><span style="color:#4CC9F0">Causalidad</span><a class="headerlink" href="#span-style-color-4cc9f0-causalidad-span" title="Enlazar permanentemente con este título">#</a></h3>
<p>En principio, no hay nada de malo en desplegar <span class="math notranslate nohighlight">\( P (x_1, \ldots, x_T) \)</span> en orden inverso. Después de todo, condicionando siempre podemos escribirlo a través de</p>
<div class="math notranslate nohighlight">
\[ P (x_1, \ldots, x_T) = \prod_ {t = T} ^ 1 P (x_t \mid x_ {t + 1}, \ldots, x_T). \]</div>
<p>De hecho, si tenemos un modelo de Markov, también podemos obtener una distribución de probabilidad condicional inversa.</p>
<p>En muchos casos, sin embargo, existe una dirección natural para los datos, es decir, avanzar en el tiempo. Está claro que los eventos futuros no pueden influir en el pasado. Por lo tanto, si cambiamos <span class="math notranslate nohighlight">\( x_t \)</span>, es posible que podamos influir en lo que sucede con <span class="math notranslate nohighlight">\( x_{t + 1} \)</span> en el futuro, pero no a la inversa. Es decir, si cambiamos <span class="math notranslate nohighlight">\( x_t \)</span>, la distribución sobre eventos pasados no cambiará. En consecuencia, debería ser más fácil explicar <span class="math notranslate nohighlight">\( P (x_{t + 1} \mid x_t) \)</span> en lugar de <span class="math notranslate nohighlight">\( P (x_t \mid x_{t + 1}) \)</span>. Por ejemplo, se ha demostrado que en algunos casos podemos encontrar <span class="math notranslate nohighlight">\( x_{t + 1} = f (x_t) + \epsilon \)</span> para algún ruido aditivo <span class="math notranslate nohighlight">\( \epsilon \)</span>, mientras que lo contrario no es cierto.</p>
</section>
</section>
<section id="span-style-color-4361ee-entrenamiento-span">
<h2><span style="color:#4361EE">Entrenamiento</span><a class="headerlink" href="#span-style-color-4361ee-entrenamiento-span" title="Enlazar permanentemente con este título">#</a></h2>
<section id="span-style-color-4cc9f0-generacion-de-datos-simulados-datos-sinteticos-span">
<h3><span style="color:#4CC9F0">Generación de datos simulados (datos sintéticos)</span><a class="headerlink" href="#span-style-color-4cc9f0-generacion-de-datos-simulados-datos-sinteticos-span" title="Enlazar permanentemente con este título">#</a></h3>
<p>Comenzamos generando algunos datos.</p>
<p>Para simplificar las cosas, generamos nuestros datos de secuencia usando una función sinusoidal con algo de ruido aditivo para los pasos de tiempo <span class="math notranslate nohighlight">\( 1, 2, \ldots, 1000 \)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Generate a total of 1000 points</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.01</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span> <span class="o">+</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">([</span><span class="n">T</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="s1">&#39;tiempo&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\User\AppData\Local\Temp\ipykernel_23876\3944349111.py:8: DeprecationWarning: `set_matplotlib_formats` is deprecated since IPython 7.23, directly use `matplotlib_inline.backend_inline.set_matplotlib_formats()`
  display.set_matplotlib_formats(&#39;svg&#39;)
</pre></div>
</div>
<img alt="../../_images/rnr_Times_series_Intro_27_1.svg" src="../../_images/rnr_Times_series_Intro_27_1.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">T</span> <span class="o">-</span> <span class="n">tau</span><span class="p">,</span> <span class="n">tau</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tau</span><span class="p">):</span>
    <span class="n">features</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">T</span> <span class="o">-</span> <span class="n">tau</span> <span class="o">+</span> <span class="n">i</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">tau</span><span class="p">:],</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(996, 4)
(996, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">features</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">labels</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([-0.04888723,  0.17735621,  0.01595857,  0.28626338], dtype=float32), array([0.07034599], dtype=float32))
(array([0.17735621, 0.01595857, 0.28626338, 0.07034599], dtype=float32), array([-0.08152123], dtype=float32))
(array([ 0.01595857,  0.28626338,  0.07034599, -0.08152123], dtype=float32), array([0.26217294], dtype=float32))
(array([ 0.28626338,  0.07034599, -0.08152123,  0.26217294], dtype=float32), array([0.12323584], dtype=float32))
(array([ 0.07034599, -0.08152123,  0.26217294,  0.12323584], dtype=float32), array([0.2230466], dtype=float32))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_train</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">600</span>
<span class="c1"># Only the first `n_train` examples are used for training</span>
<span class="n">train_iter</span> <span class="o">=</span> <span class="n">load_array</span><span class="p">((</span><span class="n">features</span><span class="p">[:</span><span class="n">n_train</span><span class="p">],</span> <span class="n">labels</span><span class="p">[:</span><span class="n">n_train</span><span class="p">]),</span>
                            <span class="n">batch_size</span><span class="p">,</span> <span class="n">is_train</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-4cc9f0-define-la-red-vainilla-que-usaremos-span">
<h3><span style="color:#4CC9F0">Define la red Vainilla que usaremos</span><a class="headerlink" href="#span-style-color-4cc9f0-define-la-red-vainilla-que-usaremos-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Vanilla MLP architecture</span>
<span class="k">def</span> <span class="nf">get_net</span><span class="p">():</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
                              <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">net</span>

<span class="c1"># Least mean squares loss</span>
<span class="c1"># Note: L2 Loss = 1/2 * MSE Loss. TensorFlow has MSE Loss that is slightly</span>
<span class="c1"># different from MXNet&#39;s L2Loss by a factor of 2. Hence we halve the loss</span>
<span class="c1"># value to get L2Loss in TF</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-4cc9f0-define-la-funcion-de-perdida-span">
<h3><span style="color:#4CC9F0">Define la función de pérdida</span><a class="headerlink" href="#span-style-color-4cc9f0-define-la-funcion-de-perdida-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MeanSquaredError</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-4cc9f0-entrenamiento-span">
<h3><span style="color:#4CC9F0">Entrenamiento</span><a class="headerlink" href="#span-style-color-4cc9f0-entrenamiento-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">train_iter</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">lr</span><span class="p">):</span>
    <span class="n">trainer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">train_iter</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
                <span class="n">l</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">trainable_variables</span>
                <span class="n">grads</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
            <span class="n">trainer</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="n">params</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;epoch </span><span class="si">{</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s1">, &#39;</span>
              <span class="sa">f</span><span class="s1">&#39;loss: </span><span class="si">{</span><span class="n">evaluate_loss</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">train_iter</span><span class="p">,</span> <span class="n">loss</span><span class="p">)</span><span class="si">:</span><span class="s1">f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">get_net</span><span class="p">()</span>
<span class="n">train</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">train_iter</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>epoch 1, loss: 0.926052
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>epoch 2, loss: 0.483714
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>epoch 3, loss: 0.245925
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>epoch 4, loss: 0.134426
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>epoch 5, loss: 0.088005
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="span-style-color-4361ee-prediccion-span">
<h2><span style="color:#4361EE">Predicción</span><a class="headerlink" href="#span-style-color-4361ee-prediccion-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>Dado que la pérdida de entrenamiento es pequeña, esperamos que nuestro modelo funcione bien. Veamos qué significa esto en la práctica. Lo primero que debe verificar es qué tan bien el modelo puede predecir lo que sucede en el siguiente paso de tiempo,
a saber, la <em>predicción de un paso adelante</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">onestep_preds</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="n">plot</span><span class="p">([</span><span class="n">time</span><span class="p">,</span> <span class="n">time</span><span class="p">[</span><span class="n">tau</span><span class="p">:]],</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">onestep_preds</span><span class="o">.</span><span class="n">numpy</span><span class="p">()],</span>
         <span class="s1">&#39;tiempo&#39;</span><span class="p">,</span>
         <span class="s1">&#39;x&#39;</span><span class="p">,</span>
         <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;datos&#39;</span><span class="p">,</span> <span class="s1">&#39;Pred 1-paso&#39;</span><span class="p">],</span>
         <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
         <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\User\AppData\Local\Temp\ipykernel_23876\3944349111.py:8: DeprecationWarning: `set_matplotlib_formats` is deprecated since IPython 7.23, directly use `matplotlib_inline.backend_inline.set_matplotlib_formats()`
  display.set_matplotlib_formats(&#39;svg&#39;)
</pre></div>
</div>
<img alt="../../_images/rnr_Times_series_Intro_40_1.svg" src="../../_images/rnr_Times_series_Intro_40_1.svg" /></div>
</div>
<p>Las predicciones de un paso adelante se ven bien, tal como esperábamos.</p>
<p>Incluso más allá de 604 (<code class="docutils literal notranslate"><span class="pre">n_train</span> <span class="pre">+</span> <span class="pre">tau</span></code>) observaciones, las predicciones siguen pareciendo fiables.</p>
<p>Sin embargo, hay un pequeño problema en esto:</p>
<ul class="simple">
<li><p>si observamos datos de secuencia solo hasta el paso de tiempo 604, no podemos esperar recibir las entradas para todas las predicciones futuras de un paso adelante.</p></li>
</ul>
<p>En cambio, tenemos que avanzar paso a paso:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\hat{x}_{605} &amp;= f(x_{601}, x_{602}, x_{603}, x_{604}), \\
\hat{x}_{606} &amp;= f(x_{602}, x_{603}, x_{604}, \hat{x}_{605}), \\
\hat{x}_{607} &amp;= f(x_{603}, x_{604}, \hat{x}_{605}, \hat{x}_{606}),\\
\hat{x}_{608} &amp;= f(x_{604}, \hat{x}_{605}, \hat{x}_{606}, \hat{x}_{607}),\\
\hat{x}_{609} &amp;= f(\hat{x}_{605}, \hat{x}_{606}, \hat{x}_{607}, \hat{x}_{608}),\\
\ldots
\end{align*}
\end{split}\]</div>
<p>Generalmente, para una secuencia observada hasta <span class="math notranslate nohighlight">\( x_t \)</span>, su salida predicha <span class="math notranslate nohighlight">\( \hat{x}_{t + k} \)</span> en el paso de tiempo <span class="math notranslate nohighlight">\( t + k \)</span> se llama <em>predicción <span class="math notranslate nohighlight">\( k \)</span>-pasos adelante</em>.</p>
<p>Como hemos observado hasta <span class="math notranslate nohighlight">\( x_{604} \)</span>, su predicción <span class="math notranslate nohighlight">\( k \)</span>-pasos adelante es <span class="math notranslate nohighlight">\( \hat{x}_{604 + k} \)</span>.</p>
<p>En otras palabras, tendremos que usar nuestras propias predicciones para hacer predicciones de varios pasos hacia adelante.</p>
<p>Veamos qué tan bien va esto.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multistep_preds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
<span class="n">multistep_preds</span><span class="p">[:</span><span class="n">n_train</span> <span class="o">+</span> <span class="n">tau</span><span class="p">]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">x</span><span class="p">[:</span><span class="n">n_train</span> <span class="o">+</span> <span class="n">tau</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_train</span> <span class="o">+</span> <span class="n">tau</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="n">multistep_preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">net</span><span class="p">(</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">multistep_preds</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">tau</span><span class="p">:</span> <span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">([</span><span class="n">time</span><span class="p">,</span> <span class="n">time</span><span class="p">[</span><span class="n">tau</span><span class="p">:],</span> <span class="n">time</span><span class="p">[</span><span class="n">n_train</span> <span class="o">+</span> <span class="n">tau</span><span class="p">:]],</span> <span class="p">[</span>
    <span class="n">x</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span>
    <span class="n">onestep_preds</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">multistep_preds</span><span class="p">[</span><span class="n">n_train</span> <span class="o">+</span> <span class="n">tau</span><span class="p">:]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="p">],</span>
         <span class="s1">&#39;tiempo&#39;</span><span class="p">,</span>
         <span class="s1">&#39;x&#39;</span><span class="p">,</span>
         <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;datos&#39;</span><span class="p">,</span> <span class="s1">&#39;preds 1-paso&#39;</span><span class="p">,</span> <span class="s1">&#39;preds multipaso&#39;</span><span class="p">],</span>
         <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
         <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\User\AppData\Local\Temp\ipykernel_23876\3944349111.py:8: DeprecationWarning: `set_matplotlib_formats` is deprecated since IPython 7.23, directly use `matplotlib_inline.backend_inline.set_matplotlib_formats()`
  display.set_matplotlib_formats(&#39;svg&#39;)
</pre></div>
</div>
<img alt="../../_images/rnr_Times_series_Intro_43_1.svg" src="../../_images/rnr_Times_series_Intro_43_1.svg" /></div>
</div>
<p>Como muestra el ejemplo anterior, este es un fracaso espectacular. Las predicciones decaen a una constante bastante rápido después de algunos pasos de predicción.</p>
<p>¿Por qué funcionó tan mal el algoritmo?</p>
<p>En última instancia, esto se debe al hecho de que los errores se acumulan.</p>
<p>Digamos que después del paso 1 tenemos algún error <span class="math notranslate nohighlight">\( \epsilon_1 = \bar \epsilon \)</span>.
Ahora la <em>entrada</em> para el paso 2 está perturbada por <span class="math notranslate nohighlight">\( \epsilon_1 \)</span>, por lo tanto, sufrimos un error del orden de <span class="math notranslate nohighlight">\( \epsilon_2 = \bar \epsilon + c \epsilon_1 \)</span> para algunos <span class="math notranslate nohighlight">\( c \)</span> constantes, y así sucesivamente.</p>
<p>El error puede diferir bastante rápidamente de las verdaderas observaciones. Este es un fenómeno común. Por ejemplo, los pronósticos meteorológicos para las próximas 24 horas tienden a ser bastante precisos, pero más allá de eso, la precisión disminuye rápidamente. Discutiremos métodos para mejorar esto a lo largo de este capítulo y más allá.</p>
<p>Echemos un vistazo más de cerca a las dificultades en las predicciones de <span class="math notranslate nohighlight">\( k \)</span> pasos adelante
calculando predicciones sobre la secuencia completa para <span class="math notranslate nohighlight">\( k = 1, 4, 16, 64 \)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_steps</span> <span class="o">=</span> <span class="mi">64</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">T</span> <span class="o">-</span> <span class="n">tau</span> <span class="o">-</span> <span class="n">max_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tau</span> <span class="o">+</span> <span class="n">max_steps</span><span class="p">)))</span>
<span class="c1"># Column `i` (`i` &lt; `tau`) are observations from `x` for time steps from</span>
<span class="c1"># `i + 1` to `i + T - tau - max_steps + 1`</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tau</span><span class="p">):</span>
    <span class="n">features</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">T</span> <span class="o">-</span> <span class="n">tau</span> <span class="o">-</span> <span class="n">max_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

<span class="c1"># Column `i` (`i` &gt;= `tau`) are the (`i - tau + 1`)-step-ahead predictions for</span>
<span class="c1"># time steps from `i + 1` to `i + T - tau - max_steps + 1`</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">tau</span> <span class="o">+</span> <span class="n">max_steps</span><span class="p">):</span>
    <span class="n">features</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">net</span><span class="p">((</span><span class="n">features</span><span class="p">[:,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">tau</span><span class="p">:</span> <span class="n">i</span><span class="p">])),</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">steps</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="n">plot</span><span class="p">([</span><span class="n">time</span><span class="p">[</span><span class="n">tau</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">T</span> <span class="o">-</span> <span class="n">max_steps</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">],</span>
         <span class="p">[</span><span class="n">features</span><span class="p">[:,</span> <span class="p">(</span><span class="n">tau</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">],</span>
         <span class="s1">&#39;time&#39;</span><span class="p">,</span>
         <span class="s1">&#39;x&#39;</span><span class="p">,</span>
         <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">-step preds&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">],</span>
         <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
         <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\User\AppData\Local\Temp\ipykernel_23876\3944349111.py:8: DeprecationWarning: `set_matplotlib_formats` is deprecated since IPython 7.23, directly use `matplotlib_inline.backend_inline.set_matplotlib_formats()`
  display.set_matplotlib_formats(&#39;svg&#39;)
</pre></div>
</div>
<img alt="../../_images/rnr_Times_series_Intro_47_1.svg" src="../../_images/rnr_Times_series_Intro_47_1.svg" /></div>
</div>
<p>Esto ilustra claramente cómo cambia la calidad de la predicción a medida que intentamos predecir más en el futuro. Si bien las predicciones de 4 pasos adelante todavía se ven bien, cualquier cosa más allá de eso es casi inútil.</p>
</section>
<section id="span-style-color-4361ee-resumen-span">
<h2><span style="color:#4361EE">Resumen</span><a class="headerlink" href="#span-style-color-4361ee-resumen-span" title="Enlazar permanentemente con este título">#</a></h2>
<ul class="simple">
<li><p>Existe una gran diferencia de dificultad entre la interpolación y la extrapolación. En consecuencia, si tiene una secuencia, siempre respete el orden temporal de los datos cuando entrene, es decir, nunca entrene con datos futuros.</p></li>
<li><p>Los modelos de secuencia requieren herramientas estadísticas especializadas para la estimación. Dos opciones populares son los modelos autorregresivos y los modelos autorregresivos de variable latente.</p></li>
<li><p>Para los modelos causales (por ejemplo, el tiempo en el futuro), estimar la dirección de avance suele ser mucho más fácil que la dirección inversa.</p></li>
<li><p>Para una secuencia observada hasta el paso de tiempo <span class="math notranslate nohighlight">\( t \)</span>, su salida predicha en el paso de tiempo <span class="math notranslate nohighlight">\( t + k \)</span> es la predicción de <span class="math notranslate nohighlight">\( k \)</span><em>- pasos adelante</em>. A medida que predecimos más en el tiempo aumentando <span class="math notranslate nohighlight">\( k \)</span>, los errores se acumulan y la calidad de la predicción se degrada, a menudo de manera espectacular.</p></li>
</ul>
</section>
<section id="span-style-color-4361ee-referencias-span">
<h2><span style="color:#4361EE">Referencias</span><a class="headerlink" href="#span-style-color-4361ee-referencias-span" title="Enlazar permanentemente con este título">#</a></h2>
<ol class="simple">
<li><p><span class="xref myst">Introducción a Redes LSTM</span></p></li>
<li><p><a class="reference external" href="https://towardsdatascience.com/time-series-forecasting-with-lstms-using-tensorflow-2-and-keras-in-python-6ceee9c6c651/">Time Series Forecasting with LSTMs using TensorFlow 2 and Keras in Python</a></p></li>
<li><p>Basado en <a class="reference external" href="https://d2l.ai/">Dive into Deep Learnig</a></p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "AprendizajeProfundo/Libro-Fundamentos",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Redes_Recurrentes\Cuadernos"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../../Redes_Neuronales/Cuadernos/NN_Animation2.html" title="anterior página">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">anterior</p>
            <p class="prev-next-title"><span style="color:#F72585">Visualización del Entrenamiento de una Red Neuronal</span></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="rnn_Intro_Redes_Recurrentes.html" title="siguiente página">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title"><span style="color:#F72585">Introducción a Redes Neuronales Recurrentes</span></p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Álvaro Mauricio Montenegro Díaz, Daniel Mauricio Montenegro Reyes<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>