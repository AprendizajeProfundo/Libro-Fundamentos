
<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Aprendizaje Profundo &#8212; Fundamentos de IA y AP</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="prev" title="Redes GRU (Gated Recurrent Unit)" href="rnr_GRU_Intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="es">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo-final-ap.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Fundamentos de IA y AP</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../tutorial.html">
                    <span style="color:#F72585">Bienvenido(a)</span>
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Conociendo el libro
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Inicio/Cuadernos/Consideraciones.html">
   <span style="color:#F72585">
    Conociendo el Libro
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fundamentos de Estadística
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Conceptos_Basicos.html">
   <span style="color:#F72585">
    Probabilidad
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Variables_Aleatorias.html">
   <span style="color:#F72585">
    Variables Aleatorias
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Var_Prob_conjunta.html">
   <span style="color:#F72585">
    Probabilidad Conjunta y Entropía Cruzada
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Distribuciones_continuas.html">
   <span style="color:#F72585">
    Distribuciones de probabilidad continuas
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Regresi%C3%B3n-Lineal-Pyton-Copy1.html">
   <span style="color:#F72585">
    Regresión Lineal en Python
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Teoría de la Información
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/ti_Teoria_Informacion.html">
   <span style="color:#F72585">
    Teoría de la Información
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Álgebra Lineal
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Intro_Tensores_I.html">
   <span style="color:#F72585">
    Introducción a tensores
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Intro_Tensores_II.html">
   <span style="color:#F72585">
    Tensores
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Tensor_Distribucion_Prob.html">
   <span style="color:#F72585">
    Tensores y distribuciones de probabilidad
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modelación
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/mod_Modelamiento.html">
   <span style="color:#F72585">
    Ejemplos de Modelos
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/mod_Ejemplo_Modelamiento.html">
   <span style="color:#F72585">
    Ejemplos de Modelamiento
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/cal_derivadas.html">
   <span style="color:#F72585">
    Introducción a la Derivación
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Optimization_1.html">
   <span style="color:#F72585">
    Optimización univariada usando JAX
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Optimization_2.html">
   <span style="color:#F72585">
    Optimización multivariada usando JAX
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/am-sdg.html">
   <span style="color:#F72585">
    Optimización
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Aprendizaje de máquinas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/am_intro_aprendizaje_maquinas.html">
   <span style="color:#F72585">
    Conceptos básicos de aprendizaje de máquinas
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/am_Regresion_logistica_JAX.html">
   <span style="color:#F72585">
    Modelo Lineal de Clasificación  con JAX
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/am_Regresion_Logistica_Tensorflow.html">
   <span style="color:#F72585">
    Modelo Logístico de Clasificación  con Tensorflow 2.X
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/am_regresion_Keras.html">
   <span style="color:#F72585">
    Regresion Basica con tf.keras: Predecir eficiencia de la gasolina
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/am-logistico-keras-cancer.html">
   <span style="color:#F72585">
    Modelo logístico de predicción en tf.keras
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Aprendizaje de máquinas no supervisado
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/BreveIntroduccion2R.html">
   <span style="color:#F72585">
    Breve introducción a R
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/AprendizajeNoSupervisado.html">
   <span style="color:#F72585">
    Aprendizaje no supervisado
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/ACP.html">
   <span style="color:#F72585">
    Análisis en componentes principales
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/ACS.html">
   <span style="color:#F72585">
    Análisis de correspondencias simples
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/ACM.html">
   <span style="color:#F72585">
    Análisis de correspondencias múltiples (ACM)
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Mapas auto-organizados (SOM)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Machine_Learning/Cuadernos/som_Introduccion.html">
   <span style="color:#F72585">
    Mapas Auto-organizados (SOM)
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Redes Neuronales
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/RedesNeuronales_intro.html">
   <span style="color:#F72585">
    Introducción a Redes Neuronales
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Activation_Functions.html">
   <span style="color:#F72585">
    Funciones de Activación
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Hello_World_ML.html">
   <span style="color:#F72585">
    Introducción a Keras Sequential y API Funcional
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Intro_Keras_Sequential.html">
   <span style="color:#F72585">
    Introducción a la API Sequential de Keras
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Intro_Keras_Functional.html">
   <span style="color:#F72585">
    Introducción a la API funcional de Keras
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/am-softmax-keras-iris.html">
   <span style="color:#F72585">
    Clasificación, Softmax, Iris
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/am_regresion_Keras_gasolina.html">
   <span style="color:#F72585">
    Regresion Basica con tf.keras: Predecir eficiencia de la gasolina
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/am-subclassing-iris.html">
   <span style="color:#F72585">
    Subclassing-Modelo de Regresión multi-logística
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/NN_Animation2.html">
   <span style="color:#F72585">
    Visualización del Entrenamiento de una Red Neuronal
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Redes Recurrentes
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="rnr_Times_series_Intro.html">
   <span style="color:#F72585">
    Introducción a Modelos Secuenciales
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rnn_Intro_Redes_Recurrentes.html">
   <span style="color:#F72585">
    Introducción a Redes Neuronales Recurrentes
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rnr_LSTM_Intro.html">
   <span style="color:#F72585">
    Redes LSTM (Long Short Term Memory Networks)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rnr_GRU_Intro.html">
   <span style="color:#F72585">
    Redes GRU (Gated Recurrent Unit)
   </span>
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   <span style="color:blue">
    <left>
     Aprendizaje Profundo
    </left>
   </span>
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/AprendizajeProfundo/Libro-Fundamentos/main?urlpath=tree/Redes_Recurrentes/Cuadernos/rnr_Times_series_Intro-lstm.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/AprendizajeProfundo/Libro-Fundamentos/blob/main/Redes_Recurrentes/Cuadernos/rnr_Times_series_Intro-lstm.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/AprendizajeProfundo/Libro-Fundamentos"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/AprendizajeProfundo/Libro-Fundamentos/issues/new?title=Issue%20on%20page%20%2FRedes_Recurrentes/Cuadernos/rnr_Times_series_Intro-lstm.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/AprendizajeProfundo/Libro-Fundamentos/edit/main/Redes_Recurrentes/Cuadernos/rnr_Times_series_Intro-lstm.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/Redes_Recurrentes/Cuadernos/rnr_Times_series_Intro-lstm.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   <span style="color:blue">
    <left>
     Aprendizaje Profundo
    </left>
   </span>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-red-center-introduccion-a-redes-neuronales-recurrentes-center-span">
   <span style="color:red">
    <center>
     Introducción a Redes Neuronales Recurrentes
    </center>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-profesores-span">
     <span style="color:blue">
      Profesores
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-asesora-medios-y-marketing-digital-span">
     <span style="color:blue">
      Asesora Medios y Marketing digital
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-asistentes-span">
     <span style="color:blue">
      Asistentes
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-referencias-span">
     <span style="color:blue">
      Referencias
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-contenido-span">
     <span style="color:blue">
      Contenido
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     <span style="color:blue">
      Referencias
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-introduccion-span">
     <span style="color:blue">
      Introducción
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-series-de-tiempo-y-aprendizaje-profundo-span">
     <span style="color:blue">
      Series de tiempo y aprendizaje profundo
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#prediccion-a-mas-de-un-paso">
       Predicción a más de un paso
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#series-multivariadas">
       Series Multivariadas
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#modelos-multivariadas-multi-cabeza">
       Modelos multivariadas multi-cabeza.
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-modelo-recurrente-span">
     <span style="color:blue">
      Modelo recurrente
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-importar-modulos-requeridos-span">
     <span style="color:blue">
      Importar módulos requeridos
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#configuraciones-basicas-generales">
       Configuraciones básicas generales
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-datos-sinteticos-span">
     <span style="color:blue">
      Datos sintéticos
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#primer-grafico-datos-simulados">
       Primer gráfico. Datos simulados.
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preprocesamiento-de-los-datos">
     Preprocesamiento de los datos
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#escala-los-datos">
       Escala los datos
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#grafico-de-datos-escalados">
       Gráfico de datos escalados
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#separacion-de-datos-entrenamiento-y-de-validacion">
       Separación de datos entrenamiento y de validación
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-que-muestra-los-datos-de-entrenamiento-y-los-de-validacion">
       Plot que muestra los datos de entrenamiento y los de validación
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-modelo-lstm-span">
     <span style="color:blue">
      Modelo LSTM
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#crea-el-modelo">
       Crea el modelo
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summary-del-modelo">
       Summary del modelo
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compila">
       Compila
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#entrenamiento">
     Entrenamiento
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluacion-del-modelo">
     Evaluación del Modelo
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#predicciones">
       Predicciones
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#serie-completa">
       Serie completa
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#periodo-de-prueba-test">
       Periodo de prueba (test)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transforma-a-la-escala-original">
     Transforma a la escala original
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-modelo-gru-span">
     <span style="color:blue">
      Modelo GRU
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Predicciones
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numero-de-parametros">
       Número de parámetros
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1><span style="color:blue"><left>Aprendizaje Profundo</left></span></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   <span style="color:blue">
    <left>
     Aprendizaje Profundo
    </left>
   </span>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-red-center-introduccion-a-redes-neuronales-recurrentes-center-span">
   <span style="color:red">
    <center>
     Introducción a Redes Neuronales Recurrentes
    </center>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-profesores-span">
     <span style="color:blue">
      Profesores
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-asesora-medios-y-marketing-digital-span">
     <span style="color:blue">
      Asesora Medios y Marketing digital
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-asistentes-span">
     <span style="color:blue">
      Asistentes
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-referencias-span">
     <span style="color:blue">
      Referencias
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-contenido-span">
     <span style="color:blue">
      Contenido
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     <span style="color:blue">
      Referencias
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-introduccion-span">
     <span style="color:blue">
      Introducción
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-series-de-tiempo-y-aprendizaje-profundo-span">
     <span style="color:blue">
      Series de tiempo y aprendizaje profundo
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#prediccion-a-mas-de-un-paso">
       Predicción a más de un paso
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#series-multivariadas">
       Series Multivariadas
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#modelos-multivariadas-multi-cabeza">
       Modelos multivariadas multi-cabeza.
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-modelo-recurrente-span">
     <span style="color:blue">
      Modelo recurrente
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-importar-modulos-requeridos-span">
     <span style="color:blue">
      Importar módulos requeridos
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#configuraciones-basicas-generales">
       Configuraciones básicas generales
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-datos-sinteticos-span">
     <span style="color:blue">
      Datos sintéticos
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#primer-grafico-datos-simulados">
       Primer gráfico. Datos simulados.
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preprocesamiento-de-los-datos">
     Preprocesamiento de los datos
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#escala-los-datos">
       Escala los datos
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#grafico-de-datos-escalados">
       Gráfico de datos escalados
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#separacion-de-datos-entrenamiento-y-de-validacion">
       Separación de datos entrenamiento y de validación
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-que-muestra-los-datos-de-entrenamiento-y-los-de-validacion">
       Plot que muestra los datos de entrenamiento y los de validación
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-modelo-lstm-span">
     <span style="color:blue">
      Modelo LSTM
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#crea-el-modelo">
       Crea el modelo
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summary-del-modelo">
       Summary del modelo
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compila">
       Compila
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#entrenamiento">
     Entrenamiento
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluacion-del-modelo">
     Evaluación del Modelo
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#predicciones">
       Predicciones
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#serie-completa">
       Serie completa
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#periodo-de-prueba-test">
       Periodo de prueba (test)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transforma-a-la-escala-original">
     Transforma a la escala original
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-blue-modelo-gru-span">
     <span style="color:blue">
      Modelo GRU
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Predicciones
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numero-de-parametros">
       Número de parámetros
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <figure>
<img src="../Imagenes/logo-final-ap.png"  width="80" height="80" align="left"/> 
</figure>
<section class="tex2jax_ignore mathjax_ignore" id="span-style-color-blue-left-aprendizaje-profundo-left-span">
<h1><span style="color:blue"><left>Aprendizaje Profundo</left></span><a class="headerlink" href="#span-style-color-blue-left-aprendizaje-profundo-left-span" title="Enlazar permanentemente con este título">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="span-style-color-red-center-introduccion-a-redes-neuronales-recurrentes-center-span">
<h1><span style="color:red"><center>Introducción a Redes Neuronales Recurrentes</center></span><a class="headerlink" href="#span-style-color-red-center-introduccion-a-redes-neuronales-recurrentes-center-span" title="Enlazar permanentemente con este título">#</a></h1>
<center> Ejemplo 1: Serie de tiempo simulada</center><section id="span-style-color-blue-profesores-span">
<h2><span style="color:blue">Profesores</span><a class="headerlink" href="#span-style-color-blue-profesores-span" title="Enlazar permanentemente con este título">#</a></h2>
<ol class="simple">
<li><p>Alvaro Mauricio Montenegro Díaz, <a class="reference external" href="mailto:ammontenegrod&#37;&#52;&#48;unal&#46;edu&#46;co">ammontenegrod<span>&#64;</span>unal<span>&#46;</span>edu<span>&#46;</span>co</a></p></li>
<li><p>Daniel Mauricio Montenegro Reyes, <a class="reference external" href="mailto:dextronomo&#37;&#52;&#48;gmail&#46;com">dextronomo<span>&#64;</span>gmail<span>&#46;</span>com</a></p></li>
<li><p>Campo Elías Pardo Turriago, <a class="reference external" href="mailto:cepardot&#37;&#52;&#48;unal&#46;edu&#46;co">cepardot<span>&#64;</span>unal<span>&#46;</span>edu<span>&#46;</span>co</a></p></li>
</ol>
</section>
<section id="span-style-color-blue-asesora-medios-y-marketing-digital-span">
<h2><span style="color:blue">Asesora Medios y Marketing digital</span><a class="headerlink" href="#span-style-color-blue-asesora-medios-y-marketing-digital-span" title="Enlazar permanentemente con este título">#</a></h2>
<ol class="simple">
<li><p>Maria del Pilar Montenegro, <a class="reference external" href="mailto:pmontenegro88&#37;&#52;&#48;gmail&#46;com">pmontenegro88<span>&#64;</span>gmail<span>&#46;</span>com</a></p></li>
</ol>
</section>
<section id="span-style-color-blue-asistentes-span">
<h2><span style="color:blue">Asistentes</span><a class="headerlink" href="#span-style-color-blue-asistentes-span" title="Enlazar permanentemente con este título">#</a></h2>
<ol class="simple">
<li><p>Oleg Jarma, <a class="reference external" href="mailto:ojarmam&#37;&#52;&#48;unal&#46;edu&#46;co">ojarmam<span>&#64;</span>unal<span>&#46;</span>edu<span>&#46;</span>co</a></p></li>
<li><p>Laura Lizarazo, <a class="reference external" href="mailto:ljlizarazore&#37;&#52;&#48;unal&#46;edu&#46;co">ljlizarazore<span>&#64;</span>unal<span>&#46;</span>edu<span>&#46;</span>co</a></p></li>
</ol>
</section>
<section id="span-style-color-blue-referencias-span">
<h2><span style="color:blue">Referencias</span><a class="headerlink" href="#span-style-color-blue-referencias-span" title="Enlazar permanentemente con este título">#</a></h2>
<ol class="simple">
<li><p><span class="xref myst">Introducción a Redes LSTM</span></p></li>
<li><p><a class="reference external" href="https://towardsdatascience.com/time-series-forecasting-with-lstms-using-tensorflow-2-and-keras-in-python-6ceee9c6c651/">Time Series Forecasting with LSTMs using TensorFlow 2 and Keras in Python</a></p></li>
<li><p><a class="reference external" href="https://d2l.ai/">Dive into Deep Learnig</a></p></li>
</ol>
</section>
<section id="span-style-color-blue-contenido-span">
<h2><span style="color:blue">Contenido</span><a class="headerlink" href="#span-style-color-blue-contenido-span" title="Enlazar permanentemente con este título">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#Introducci%C3%B3n">Introducción</a></p></li>
<li><p><a class="reference external" href="#Series-de-tiempo-y-aprendizaje-profundo">Series de tiempo y aprendizaje profundo</a></p></li>
<li><p><span class="xref myst">Modelo recurrente</span></p></li>
<li><p><a class="reference external" href="#Importar-m%C3%B3dulos-requeridos">Importar módulos requeridos</a></p></li>
<li><p><a class="reference external" href="#Datos-sint%C3%A9ticos">Datos sintéticos</a></p></li>
<li><p><a class="reference external" href="#Modelo-LSTM">Modelo LSTM</a></p></li>
<li><p><a class="reference external" href="#Modelo-GRU">Modelo GRU</a></p></li>
</ul>
</section>
<section id="id1">
<h2><span style="color:blue">Referencias</span><a class="headerlink" href="#id1" title="Enlazar permanentemente con este título">#</a></h2>
<ol class="simple">
<li><p><span class="xref myst">Introducción a Redes LSTM</span></p></li>
<li><p><a class="reference external" href="https://towardsdatascience.com/time-series-forecasting-with-lstms-using-tensorflow-2-and-keras-in-python-6ceee9c6c651/">Time Series Forecasting with LSTMs using TensorFlow 2 and Keras in Python</a></p></li>
</ol>
</section>
<section id="span-style-color-blue-introduccion-span">
<h2><span style="color:blue">Introducción</span><a class="headerlink" href="#span-style-color-blue-introduccion-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>Los datos de la serie temporal introducen una «dependencia dura» de los pasos de tiempo anteriores, por lo que no se cumple la independencia de las observaciones. ¿Cuáles son algunas de las propiedades que puede tener una serie temporal?</p>
<p>La <em>estacionalidad</em> y la <em>autocorrelación</em> son algunas de las propiedades de la serie temporal en las que puede estar interesado.</p>
<p>Se dice que una serie de tiempos es <strong>estacionaria</strong> cuando la media y la varianza permanecen constantes en el tiempo.</p>
<p>Una serie temporal tiene una <strong>tendencia</strong> si la media varía con el tiempo. A menudo puede eliminarlo y hacer que la serie sea estacionaria aplicando transformación(es) logarítmicas de los datos.</p>
<p><strong>La estacionalidad</strong> se refiere al fenómeno de las variaciones en plazos específicos. por ejemplo, personas que compran más árboles de Navidad durante Navidad (quién lo hubiera pensado). Un enfoque común para eliminar la estacionalidad es usar la diferenciación.</p>
<p><strong>La autocorrelación</strong> se refiere a la correlación entre el valor actual con una copia de un tiempo anterior (retraso).</p>
<p>Usaremos redes neuronales para el modelamiento de esta series.</p>
</section>
<section id="span-style-color-blue-series-de-tiempo-y-aprendizaje-profundo-span">
<h2><span style="color:blue">Series de tiempo y aprendizaje profundo</span><a class="headerlink" href="#span-style-color-blue-series-de-tiempo-y-aprendizaje-profundo-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>Una serie de tiempo univariada es una sucesión de valores en el tiempo, digamos</p>
<div class="math notranslate nohighlight">
\[
x_1, x_2, x_3, \ldots x_T.
\]</div>
<p>Por ejemplo consideremos la serie dada pos los siguientes valores:</p>
<div class="math notranslate nohighlight">
\[\{3.4, 5.2, 4.6, 6.2, 5.5, 4.0, 7.2, 8.1, 6.9, 9.2, 9.5, 9.8, 8.9, 9.6, 9.7, 9.9 \}
\]</div>
<p>El problema de hacer pronósticos a partir de una serie de tiempo puede verse como un problema de aprendizaje profundo , si la información se organiza inicialmente como un problema de regresión o de clasificación. La siguiente imagen ilustra el procedimiento más común.</p>
<figure>
<img src="../Imagenes/series.jpg"  width="800" height="800" align="center"/> 
</figure><p>En la imagen se observan varias cosas interesantes.</p>
<ol class="simple">
<li><p>Los datos de la serie se han organizado como si se tuviera un regresión. La matriz de diseño <span class="math notranslate nohighlight">\(X\)</span> está constituida por filas con 8 columnas. El número de columnas corresponde al rezago (número de pasos hacia atrás en la serie para poder predecir el sigueinte valor.</p></li>
<li><p>La variable de interés <span class="math notranslate nohighlight">\(Y\)</span> es la variable que se quiere predecir.</p></li>
</ol>
<p>Observe que para la primera fila se tomaron los primeros 8 datos de la serie y el valor de la variable a predecir es la novena observación. En la segunda fila nos hemos desplazado un casilla a la derecha en la serie.</p>
<p>Puesto de esta forma, cada fila de la matriz <span class="math notranslate nohighlight">\(X\)</span> es independiente de las demás y constituye un tensor de dimensión 1 en la entrada de una red neuronal. La variable target es es el tensor <span class="math notranslate nohighlight">\(Y\)</span>.La entrada completa a la red es un tensor de dimensión 2.</p>
<p>Visto así, tenemos un problema de aprendizaje profundo, por lo que un por ejemplo un perceptron podría usarse para construir un modelo predictivo.</p>
<section id="prediccion-a-mas-de-un-paso">
<h3>Predicción a más de un paso<a class="headerlink" href="#prediccion-a-mas-de-un-paso" title="Enlazar permanentemente con este título">#</a></h3>
<p>Si lo que se desea es hacer predicciones, varios pasos adelante y no del siguiente paso, el único cambio es en la variable objetivo (target). La imagen muestra el caso de predicciones tres pasos adelante. Observe que en este caso la variable objetivo se toma tres pasos adelante del último elemento de la matriz <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>Observe además que las dos últimas filas de la matriz no se pueden utilizar, debido a que no tenemos datos más allá de el último dato de la serie.</p>
<figure>
<img src="../Imagenes/prediccion_tres_dias.jpg"  width="800" height="800" align="center"/> 
</figure></section>
<section id="series-multivariadas">
<h3>Series Multivariadas<a class="headerlink" href="#series-multivariadas" title="Enlazar permanentemente con este título">#</a></h3>
<p>En algunas situaciones tenemos  más de una serie. La siguiente imagen muestra la nueva situación.</p>
<figure>
<img src="../Imagenes/Serie_Multivariada.jpg"  width="800" height="800" align="center"/> 
</figure><p>Como se observa, ahora los tensores de datos de entrada tiene una dimensión más, la cual en el lenguaje de los modelos convolucionales, que estudiarmeos más adelante, llamaremos canales. En el ejemplo, se muestra como se preparan los datos de tres series de tiempos para tratarlos como un problema de aprendizaje profundo.</p>
<p>La imagen ilustra claramente, la semejanza con los datos de imágenes en donde hay varios canales de color. Esta forma de organización de los datos para aprendizaje profundo llevó a los diseñadores de capas neuronales para este tipo de problemas a considerar tanto en problemas de visión por computador como para redes recurrentes, que los tensores de entrada siempre sean de dimensión 3: largo, ancho y canales.</p>
<p>En el caso de las series siempre se tendrá</p>
<ol class="simple">
<li><p>tamaño de batch, por ejemplo 32,</p></li>
<li><p>longitud del rezago, por ejemplo 8,</p></li>
<li><p>número de canales, por ejemplo 3.</p></li>
</ol>
<p>Adicionalmente puede verse que la variable objetivo tiene por lo menos el tamaño del batch. Este tensor puede tener una segunda dimensión que podría corresponder  al número de canales, pero no es necesario. Por ejemplo, podría tenerse que la variable objetivo podría ser el promedio de los valores predichos de cada acanal.</p>
</section>
<section id="modelos-multivariadas-multi-cabeza">
<h3>Modelos multivariadas multi-cabeza.<a class="headerlink" href="#modelos-multivariadas-multi-cabeza" title="Enlazar permanentemente con este título">#</a></h3>
<p>Una vez las series de tiempo se presentan como un problema de aprendizaje profundo, es posible pensar en diferentes arquitecturas de redes. La siguiente imagen presenta un alternativa que consiste en que cada serie entran por una camino diferente a la red, sigue un camino separado por un tiempo y luego las predicciones se concadenan para llegar a una predicción final.</p>
<figure>
<img src="../Imagenes/multicabeza.jpg"  width="800" height="800" align="center"/> 
</figure></section>
</section>
<section id="span-style-color-blue-modelo-recurrente-span">
<h2><span style="color:blue">Modelo recurrente</span><a class="headerlink" href="#span-style-color-blue-modelo-recurrente-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>La siguiente imagen muestra la estructura general de una capa recurrente. LSTM es un caso particular y el gráfico ilustra bien la forma de procesamiento.</p>
<figure>
<img src="../Imagenes/modelo_recurrente.jpg"  width="800" height="800" align="center"/> 
</figure><p>Comenzaremos con un ejemplo simple de pronosticar los valores de la función seno utilizando una red LSTM simple. Este código puede ser usado como base para la implementación de modelos mas complejos. Para un introdución teórica a las redes LSTM consulte el cuaderno <span class="xref myst">Redes LSTM (Long Short Term Memory Networks)</span>.</p>
</section>
<section id="span-style-color-blue-importar-modulos-requeridos-span">
<h2><span style="color:blue">Importar módulos requeridos</span><a class="headerlink" href="#span-style-color-blue-importar-modulos-requeridos-span" title="Enlazar permanentemente con este título">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1">#import seaborn as sns</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="c1">#from tensorflow import keras</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">LSTM</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">GRU</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">plot_model</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="c1">#</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Versión de Tensorflow: &quot;</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Versión de Tensorflow:  2.9.1
</pre></div>
</div>
</div>
</div>
<section id="configuraciones-basicas-generales">
<h3>Configuraciones básicas generales<a class="headerlink" href="#configuraciones-basicas-generales" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format=&#39;retina&#39;
<span class="c1">#</span>
<span class="c1">#sns.set(style=&#39;whitegrid&#39;, palette=&#39;muted&#39;, font_scale=1.5)</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">10</span>
<span class="c1">#</span>

<span class="c1">#tf.random.set_seed(RANDOM_SEED)</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="span-style-color-blue-datos-sinteticos-span">
<h2><span style="color:blue">Datos sintéticos</span><a class="headerlink" href="#span-style-color-blue-datos-sinteticos-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>Vamos a generar unos datos que siguen un comportamiento sinosoidal, con una tendencia ascendiente. Se introduce ruido Gaussiano.</p>
<p>Modifique las siguientes dos líneas y haga su priopia simulación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="n">RANDOM_SEED</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">RANDOM_SEED</span><span class="p">)</span>
<span class="n">trend</span> <span class="o">=</span> <span class="mf">.1</span>
<span class="c1">#</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">sin</span> <span class="o">=</span>  <span class="n">trend</span><span class="o">*</span><span class="n">time</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<section id="primer-grafico-datos-simulados">
<h3>Primer gráfico. Datos simulados.<a class="headerlink" href="#primer-grafico-datos-simulados" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Función seno con tendencia ascendente y ruido Gaussiano&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Serie de tiempo simulada, con la función seno y una tendencia&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/rnr_Times_series_Intro-lstm_43_0.png" src="../../_images/rnr_Times_series_Intro-lstm_43_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Número de datos: &#39;</span><span class="p">,</span> <span class="n">sin</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de datos:  1000
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="preprocesamiento-de-los-datos">
<h2>Preprocesamiento de los datos<a class="headerlink" href="#preprocesamiento-de-los-datos" title="Enlazar permanentemente con este título">#</a></h2>
<section id="escala-los-datos">
<h3>Escala los datos<a class="headerlink" href="#escala-los-datos" title="Enlazar permanentemente con este título">#</a></h3>
<p>Introducimos un instancia de clase del escalador <em>MinMaxScaler</em> para llevar los datos a la escala <span class="math notranslate nohighlight">\([0,1]\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#crea un dataset </span>
<span class="c1">#</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sin</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;serie&#39;</span><span class="p">])</span>
<span class="c1"># crea el objeto  scaler y escala los datos</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">scaled_data</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">df1</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;serie&#39;</span><span class="p">])</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1000, 1)
</pre></div>
</div>
</div>
</div>
</section>
<section id="grafico-de-datos-escalados">
<h3>Gráfico de datos escalados<a class="headerlink" href="#grafico-de-datos-escalados" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#serie_0_1 = dataset.serie_0_1.values</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos estandarizados a escala [0,1]&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Serie de tiempo simulada, con la función seno y una tendencia&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/rnr_Times_series_Intro-lstm_51_0.png" src="../../_images/rnr_Times_series_Intro-lstm_51_0.png" />
</div>
</div>
</section>
<section id="separacion-de-datos-entrenamiento-y-de-validacion">
<h3>Separación de datos entrenamiento y de validación<a class="headerlink" href="#separacion-de-datos-entrenamiento-y-de-validacion" title="Enlazar permanentemente con este título">#</a></h3>
<p>En el caso de las series de tiempo, los datos de entrenamiento se toman desde el comienzo de la serie y los de validación desde el final hacia atras.</p>
<p>Veamos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">test_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">-</span> <span class="n">train_size</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">train_size</span><span class="p">],</span> <span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_size</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">df1</span><span class="p">)]</span>
<span class="n">len_train</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">len_test</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">len_train</span><span class="p">,</span> <span class="n">len_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>800 200
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(800, 1)
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-que-muestra-los-datos-de-entrenamiento-y-los-de-validacion">
<h3>Plot que muestra los datos de entrenamiento y los de validación<a class="headerlink" href="#plot-que-muestra-los-datos-de-entrenamiento-y-los-de-validacion" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plt.figure(figsize=(16,8))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Conjunto de entrenamiento (Training set): &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">len_train</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; puntos (80%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Conjunto de Validación (Validation set): &#39;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">len_test</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; puntos (20%)&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Serie de tiempo simulada, con la función seno y una tendencia&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/rnr_Times_series_Intro-lstm_57_0.png" src="../../_images/rnr_Times_series_Intro-lstm_57_0.png" />
</div>
</div>
<p>Preparar los datos para la predicción de series temporales (LSTM en particular) puede ser complicado.</p>
<p>Intuitivamente, necesitamos predecir el valor en el paso de tiempo actual utilizando el historial (<span class="math notranslate nohighlight">\(n\)</span> pasos de tiempo hacia atrás a partir de él).</p>
<p>Aquí se propone una función genérica que hace el trabajo</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># crea dos listas vacias para depositar los datos</span>
    <span class="n">Xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="c1"># el primer lote de datos empieza en la primera observación</span>
    <span class="c1"># y toma time_steps  datos.</span>
    <span class="c1"># Comienza a avanzar hacia adelante.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="n">time_steps</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:(</span><span class="n">i</span> <span class="o">+</span> <span class="n">time_steps</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">Xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">time_steps</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Xs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>La belleza de esta función es que trabaja con datos de series temporales univariadas (función única) y multivariadas (funciones múltiples). Usemos un historial de 50 pasos de tiempo para hacer nuestras secuencias. Esto significa que vamos a conservar la historia de 50 pasos atrás para predecir el valor actual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_steps</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># reshape to [samples, time_steps, n_features]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">([</span><span class="n">X_train</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,],</span> <span class="n">y_train</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(750, 50, 1) (750, 1)
[array([[[0.12866229],
        [0.1121937 ],
        [0.15199099],
        [0.19517542],
        [0.13373672],
        [0.14166865],
        [0.2211258 ],
        [0.19603986],
        [0.15358548],
        [0.19974127],
        [0.16525499],
        [0.16990083],
        [0.20199465],
        [0.11982438],
        [0.12982285],
        [0.17767362],
        [0.16076588],
        [0.21355511],
        [0.16446774],
        [0.14307962],
        [0.25505916],
        [0.1851261 ],
        [0.19321062],
        [0.12984983],
        [0.15998183],
        [0.18065415],
        [0.12482759],
        [0.17917075],
        [0.13392128],
        [0.13937234],
        [0.12008995],
        [0.21029807],
        [0.12917938],
        [0.0806848 ],
        [0.14828083],
        [0.0604929 ],
        [0.11070353],
        [0.01858177],
        [0.03791053],
        [0.09315708],
        [0.10995165],
        [0.08338189],
        [0.06856677],
        [0.05846956],
        [0.00976347],
        [0.03858453],
        [0.04837435],
        [0.10885778],
        [0.08165597],
        [0.        ]],

       [[0.1121937 ],
        [0.15199099],
        [0.19517542],
        [0.13373672],
        [0.14166865],
        [0.2211258 ],
        [0.19603986],
        [0.15358548],
        [0.19974127],
        [0.16525499],
        [0.16990083],
        [0.20199465],
        [0.11982438],
        [0.12982285],
        [0.17767362],
        [0.16076588],
        [0.21355511],
        [0.16446774],
        [0.14307962],
        [0.25505916],
        [0.1851261 ],
        [0.19321062],
        [0.12984983],
        [0.15998183],
        [0.18065415],
        [0.12482759],
        [0.17917075],
        [0.13392128],
        [0.13937234],
        [0.12008995],
        [0.21029807],
        [0.12917938],
        [0.0806848 ],
        [0.14828083],
        [0.0604929 ],
        [0.11070353],
        [0.01858177],
        [0.03791053],
        [0.09315708],
        [0.10995165],
        [0.08338189],
        [0.06856677],
        [0.05846956],
        [0.00976347],
        [0.03858453],
        [0.04837435],
        [0.10885778],
        [0.08165597],
        [0.        ],
        [0.08542093]]]), array([[0.08542093],
       [0.06071886]])]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(750, 50, 1)
(750, 1)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="span-style-color-blue-modelo-lstm-span">
<h2><span style="color:blue">Modelo LSTM</span><a class="headerlink" href="#span-style-color-blue-modelo-lstm-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>Entrenar un modelo LSTM en Keras es fácil. Utilizaremos la capa LSTM en un modelo secuencial para hacer nuestras predicciones:</p>
<section id="crea-el-modelo">
<h3>Crea el modelo<a class="headerlink" href="#crea-el-modelo" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># shapes</span>
<span class="n">inputs_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">lstm_output</span> <span class="o">=</span> <span class="mi">60</span>

<span class="c1"># layers</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">inputs_shape</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">LSTM</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">lstm_output</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LSTM_layer&#39;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># model</span>
<span class="n">serie_0_1_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;series_LSTM_model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inputs_shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(50, 1)
</pre></div>
</div>
</div>
</div>
</section>
<section id="summary-del-modelo">
<h3>Summary del modelo<a class="headerlink" href="#summary-del-modelo" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#model = keras.Sequential()</span>
<span class="c1">#model.add(keras.layers.LSTM(units=lstm_output,  input_shape=(X_train.shape[1], X_train.shape[2])))</span>
<span class="c1">#model.add(keras.layers.Dense(units=1))</span>
<span class="n">serie_0_1_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="n">plot_model</span><span class="p">(</span><span class="n">serie_0_1_model</span><span class="p">,</span> <span class="n">to_file</span><span class="o">=</span><span class="s1">&#39;../Imagenes/series_LSTM_model.png&#39;</span><span class="p">,</span> 
           <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model: &quot;series_LSTM_model&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_________________________________________________________________
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Layer (type)                Output Shape              Param #   
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=================================================================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> input_1 (InputLayer)        [(None, 50, 1)]           0         
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> LSTM_layer (LSTM)           (None, 60)                14880     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> dense (Dense)               (None, 1)                 61        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=================================================================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total params: 14,941
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trainable params: 14,941
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Non-trainable params: 0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_________________________________________________________________
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You must install pydot (`pip install pydot`) and install graphviz (see instructions at https://graphviz.gitlab.io/download/) for plot_model/model_to_dot to work.
</pre></div>
</div>
</div>
</div>
<p>Significa que el modelo tiene la primera de tipo LSTM capa con un input de tamaño <span class="math notranslate nohighlight">\((50,1)\)</span> y una salida de 60 neuronas.</p>
<p>La segunda es una capa densa con entrada 60 neuronas y salida una neurona</p>
<p>El cálculo del número de neuronas es como sigue:</p>
<div class="math notranslate nohighlight">
\[
\text{Número de parámetros capa LSTM } = 4(p^2+ pn +p)
\]</div>
<p>en donde <span class="math notranslate nohighlight">\(p\)</span> es el tamaño de salida y <span class="math notranslate nohighlight">\(n\)</span> el tamaño de entrada.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lstm_output</span> <span class="o">=</span><span class="mi">60</span>
<span class="n">input_size</span> <span class="o">=</span><span class="mi">1</span> <span class="c1"># input size in the LSTM machine</span>
<span class="c1">#</span>
<span class="c1"># cada entrada de tamaño 50 es mostrada a la máquina  LSTM machine uno por uno.</span>
<span class="c1"># luego se tiene</span>
<span class="c1">#</span>
<span class="n">num_params</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">lstm_output</span><span class="o">*</span><span class="n">lstm_output</span> <span class="o">+</span> <span class="n">lstm_output</span><span class="o">*</span><span class="n">input_size</span><span class="o">+</span> <span class="n">lstm_output</span><span class="p">)</span>
<span class="n">num_params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14880
</pre></div>
</div>
</div>
</div>
</section>
<section id="compila">
<h3>Compila<a class="headerlink" href="#compila" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">serie_0_1_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">,</span>
  <span class="n">optimizer</span><span class="o">=</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="entrenamiento">
<h2>Entrenamiento<a class="headerlink" href="#entrenamiento" title="Enlazar permanentemente con este título">#</a></h2>
<p>Lo más importante para recordar al entrenar modelos de series temporales es no mezclar los datos (el orden de los datos es importante). El resto es bastante estándar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">serie_0_1_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 2:30 - loss: 0.0779
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 4/43 [=&gt;............................] - ETA: 0s - loss: 0.0928  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 0s - loss: 0.0691
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
10/43 [=====&gt;........................] - ETA: 0s - loss: 0.0509
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
13/43 [========&gt;.....................] - ETA: 0s - loss: 0.0429
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
16/43 [==========&gt;...................] - ETA: 0s - loss: 0.0367
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
18/43 [===========&gt;..................] - ETA: 0s - loss: 0.0331
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0290
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
24/43 [===============&gt;..............] - ETA: 0s - loss: 0.0265
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0245
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
30/43 [===================&gt;..........] - ETA: 0s - loss: 0.0225
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0208
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
36/43 [========================&gt;.....] - ETA: 0s - loss: 0.0194
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0183
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
42/43 [============================&gt;.] - ETA: 0s - loss: 0.0172
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 6s 50ms/step - loss: 0.0172 - val_loss: 0.0038
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 2/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0030
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 4/43 [=&gt;............................] - ETA: 0s - loss: 0.0040
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 6/43 [===&gt;..........................] - ETA: 0s - loss: 0.0036
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 0s - loss: 0.0035
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
12/43 [=======&gt;......................] - ETA: 0s - loss: 0.0032
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/43 [========&gt;.....................] - ETA: 0s - loss: 0.0033
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
17/43 [==========&gt;...................] - ETA: 0s - loss: 0.0032
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
19/43 [============&gt;.................] - ETA: 0s - loss: 0.0031
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
22/43 [==============&gt;...............] - ETA: 0s - loss: 0.0031
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
25/43 [================&gt;.............] - ETA: 0s - loss: 0.0031
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0032
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
30/43 [===================&gt;..........] - ETA: 0s - loss: 0.0032
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0032
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
35/43 [=======================&gt;......] - ETA: 0s - loss: 0.0031
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
37/43 [========================&gt;.....] - ETA: 0s - loss: 0.0032
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0031
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
41/43 [===========================&gt;..] - ETA: 0s - loss: 0.0031
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - ETA: 0s - loss: 0.0031
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 28ms/step - loss: 0.0031 - val_loss: 0.0029
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 3/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 6/43 [===&gt;..........................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
12/43 [=======&gt;......................] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
15/43 [=========&gt;....................] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
18/43 [===========&gt;..................] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
24/43 [===============&gt;..............] - ETA: 0s - loss: 0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
26/43 [=================&gt;............] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
28/43 [==================&gt;...........] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
30/43 [===================&gt;..........] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/43 [=====================&gt;........] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
34/43 [======================&gt;.......] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
36/43 [========================&gt;.....] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
38/43 [=========================&gt;....] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
40/43 [==========================&gt;...] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 28ms/step - loss: 0.0027 - val_loss: 0.0029
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 4/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 6/43 [===&gt;..........................] - ETA: 0s - loss: 0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
12/43 [=======&gt;......................] - ETA: 0s - loss: 0.0030
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/43 [========&gt;.....................] - ETA: 0s - loss: 0.0029
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
16/43 [==========&gt;...................] - ETA: 0s - loss: 0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
18/43 [===========&gt;..................] - ETA: 0s - loss: 0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
20/43 [============&gt;.................] - ETA: 0s - loss: 0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
23/43 [===============&gt;..............] - ETA: 0s - loss: 0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
26/43 [=================&gt;............] - ETA: 0s - loss: 0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
29/43 [===================&gt;..........] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
31/43 [====================&gt;.........] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
34/43 [======================&gt;.......] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
36/43 [========================&gt;.....] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
38/43 [=========================&gt;....] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
40/43 [==========================&gt;...] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
42/43 [============================&gt;.] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 27ms/step - loss: 0.0026 - val_loss: 0.0025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 5/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 4/43 [=&gt;............................] - ETA: 1s - loss: 0.0025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
10/43 [=====&gt;........................] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
13/43 [========&gt;.....................] - ETA: 0s - loss: 0.0025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
15/43 [=========&gt;....................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
17/43 [==========&gt;...................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
19/43 [============&gt;.................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
23/43 [===============&gt;..............] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
25/43 [================&gt;.............] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
29/43 [===================&gt;..........] - ETA: 0s - loss: 0.0025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
31/43 [====================&gt;.........] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
34/43 [======================&gt;.......] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
37/43 [========================&gt;.....] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
41/43 [===========================&gt;..] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 28ms/step - loss: 0.0024 - val_loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 6/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0032
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 4/43 [=&gt;............................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
10/43 [=====&gt;........................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
12/43 [=======&gt;......................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/43 [========&gt;.....................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
17/43 [==========&gt;...................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
20/43 [============&gt;.................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
23/43 [===============&gt;..............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
25/43 [================&gt;.............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
30/43 [===================&gt;..........] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
36/43 [========================&gt;.....] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
42/43 [============================&gt;.] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 27ms/step - loss: 0.0024 - val_loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 7/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 4/43 [=&gt;............................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 0s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
10/43 [=====&gt;........................] - ETA: 0s - loss: 0.0026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
12/43 [=======&gt;......................] - ETA: 0s - loss: 0.0025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
15/43 [=========&gt;....................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
18/43 [===========&gt;..................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
20/43 [============&gt;.................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
22/43 [==============&gt;...............] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
24/43 [===============&gt;..............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
29/43 [===================&gt;..........] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
31/43 [====================&gt;.........] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
34/43 [======================&gt;.......] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
37/43 [========================&gt;.....] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
42/43 [============================&gt;.] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 26ms/step - loss: 0.0022 - val_loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 8/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 1s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 1s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/43 [======&gt;.......................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
13/43 [========&gt;.....................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
15/43 [=========&gt;....................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
18/43 [===========&gt;..................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
23/43 [===============&gt;..............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
26/43 [=================&gt;............] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
29/43 [===================&gt;..........] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
31/43 [====================&gt;.........] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
35/43 [=======================&gt;......] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
37/43 [========================&gt;.....] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
41/43 [===========================&gt;..] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 30ms/step - loss: 0.0022 - val_loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 9/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 0s - loss: 0.0016
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0029
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 8/43 [====&gt;.........................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/43 [======&gt;.......................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/43 [========&gt;.....................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
16/43 [==========&gt;...................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
19/43 [============&gt;.................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
23/43 [===============&gt;..............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
25/43 [================&gt;.............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
29/43 [===================&gt;..........] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
31/43 [====================&gt;.........] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
36/43 [========================&gt;.....] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
38/43 [=========================&gt;....] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
40/43 [==========================&gt;...] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
42/43 [============================&gt;.] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 32ms/step - loss: 0.0022 - val_loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 10/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0017
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 1s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 8/43 [====&gt;.........................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
10/43 [=====&gt;........................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
12/43 [=======&gt;......................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/43 [========&gt;.....................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
16/43 [==========&gt;...................] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
18/43 [===========&gt;..................] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
20/43 [============&gt;.................] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
22/43 [==============&gt;...............] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
24/43 [===============&gt;..............] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
26/43 [=================&gt;............] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
28/43 [==================&gt;...........] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
30/43 [===================&gt;..........] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/43 [=====================&gt;........] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
34/43 [======================&gt;.......] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
36/43 [========================&gt;.....] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
38/43 [=========================&gt;....] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
40/43 [==========================&gt;...] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
42/43 [============================&gt;.] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 2s 40ms/step - loss: 0.0022 - val_loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 11/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 6/43 [===&gt;..........................] - ETA: 1s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 8/43 [====&gt;.........................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
10/43 [=====&gt;........................] - ETA: 1s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
12/43 [=======&gt;......................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/43 [========&gt;.....................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
16/43 [==========&gt;...................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
18/43 [===========&gt;..................] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
24/43 [===============&gt;..............] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
26/43 [=================&gt;............] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
28/43 [==================&gt;...........] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
30/43 [===================&gt;..........] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/43 [=====================&gt;........] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
34/43 [======================&gt;.......] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
36/43 [========================&gt;.....] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
38/43 [=========================&gt;....] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
40/43 [==========================&gt;...] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
42/43 [============================&gt;.] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 34ms/step - loss: 0.0021 - val_loss: 0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 12/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0014
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/43 [======&gt;.......................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
13/43 [========&gt;.....................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
15/43 [=========&gt;....................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
17/43 [==========&gt;...................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
19/43 [============&gt;.................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
23/43 [===============&gt;..............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
25/43 [================&gt;.............] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
29/43 [===================&gt;..........] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
31/43 [====================&gt;.........] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
35/43 [=======================&gt;......] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
37/43 [========================&gt;.....] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
41/43 [===========================&gt;..] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 34ms/step - loss: 0.0021 - val_loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 13/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 5.2013e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0017    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/43 [======&gt;.......................] - ETA: 1s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
13/43 [========&gt;.....................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
15/43 [=========&gt;....................] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
17/43 [==========&gt;...................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
19/43 [============&gt;.................] - ETA: 0s - loss: 0.0018
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0018
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
23/43 [===============&gt;..............] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
25/43 [================&gt;.............] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
29/43 [===================&gt;..........] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
31/43 [====================&gt;.........] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
35/43 [=======================&gt;......] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
37/43 [========================&gt;.....] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
41/43 [===========================&gt;..] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 31ms/step - loss: 0.0020 - val_loss: 0.0030
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 14/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0013
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0018
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 1s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
12/43 [=======&gt;......................] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/43 [========&gt;.....................] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
16/43 [==========&gt;...................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
18/43 [===========&gt;..................] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
20/43 [============&gt;.................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
22/43 [==============&gt;...............] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
24/43 [===============&gt;..............] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
26/43 [=================&gt;............] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
28/43 [==================&gt;...........] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
30/43 [===================&gt;..........] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
36/43 [========================&gt;.....] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
42/43 [============================&gt;.] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 28ms/step - loss: 0.0021 - val_loss: 0.0076
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 15/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0017
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/43 [======&gt;.......................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
13/43 [========&gt;.....................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
15/43 [=========&gt;....................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
17/43 [==========&gt;...................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
19/43 [============&gt;.................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
23/43 [===============&gt;..............] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
25/43 [================&gt;.............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
29/43 [===================&gt;..........] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
31/43 [====================&gt;.........] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
35/43 [=======================&gt;......] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
37/43 [========================&gt;.....] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
41/43 [===========================&gt;..] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 30ms/step - loss: 0.0024 - val_loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 16/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0012
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0013
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 8/43 [====&gt;.........................] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
10/43 [=====&gt;........................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
13/43 [========&gt;.....................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
16/43 [==========&gt;...................] - ETA: 0s - loss: 0.0017
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
19/43 [============&gt;.................] - ETA: 0s - loss: 0.0018
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
22/43 [==============&gt;...............] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
24/43 [===============&gt;..............] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
30/43 [===================&gt;..........] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
35/43 [=======================&gt;......] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
37/43 [========================&gt;.....] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
41/43 [===========================&gt;..] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 27ms/step - loss: 0.0020 - val_loss: 0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 17/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0018
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/43 [======&gt;.......................] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
13/43 [========&gt;.....................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
15/43 [=========&gt;....................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
17/43 [==========&gt;...................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
19/43 [============&gt;.................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
23/43 [===============&gt;..............] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
25/43 [================&gt;.............] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
28/43 [==================&gt;...........] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
30/43 [===================&gt;..........] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/43 [=====================&gt;........] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
34/43 [======================&gt;.......] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
36/43 [========================&gt;.....] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
38/43 [=========================&gt;....] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
40/43 [==========================&gt;...] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
42/43 [============================&gt;.] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 29ms/step - loss: 0.0020 - val_loss: 0.0038
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 18/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0011
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0029
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 0s - loss: 0.0025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/43 [======&gt;.......................] - ETA: 0s - loss: 0.0025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
13/43 [========&gt;.....................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
15/43 [=========&gt;....................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
17/43 [==========&gt;...................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
19/43 [============&gt;.................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
24/43 [===============&gt;..............] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
26/43 [=================&gt;............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
28/43 [==================&gt;...........] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
30/43 [===================&gt;..........] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/43 [=====================&gt;........] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
34/43 [======================&gt;.......] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
36/43 [========================&gt;.....] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
41/43 [===========================&gt;..] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 30ms/step - loss: 0.0023 - val_loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 19/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0015
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0015
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 0s - loss: 0.0016
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 0s - loss: 0.0017
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/43 [======&gt;.......................] - ETA: 0s - loss: 0.0018
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/43 [========&gt;.....................] - ETA: 0s - loss: 0.0018
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
17/43 [==========&gt;...................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
19/43 [============&gt;.................] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
23/43 [===============&gt;..............] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
25/43 [================&gt;.............] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
29/43 [===================&gt;..........] - ETA: 0s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
31/43 [====================&gt;.........] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
35/43 [=======================&gt;......] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
37/43 [========================&gt;.....] - ETA: 0s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
39/43 [==========================&gt;...] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
42/43 [============================&gt;.] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
43/43 [==============================] - 1s 29ms/step - loss: 0.0022 - val_loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 20/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/43 [..............................] - ETA: 1s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3/43 [=&gt;............................] - ETA: 1s - loss: 0.0019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5/43 [==&gt;...........................] - ETA: 1s - loss: 0.0020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7/43 [===&gt;..........................] - ETA: 1s - loss: 0.0021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9/43 [=====&gt;........................] - ETA: 1s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/43 [======&gt;.......................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
13/43 [========&gt;.....................] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
15/43 [=========&gt;....................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
17/43 [==========&gt;...................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
19/43 [============&gt;.................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
21/43 [=============&gt;................] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
23/43 [===============&gt;..............] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
25/43 [================&gt;.............] - ETA: 0s - loss: 0.0024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
27/43 [=================&gt;............] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
30/43 [===================&gt;..........] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
33/43 [======================&gt;.......] - ETA: 0s - loss: 0.0023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
36/43 [========================&gt;.....] - ETA: 0s - loss: 0.0022
</pre></div>
</div>
</div>
</div>
</section>
<section id="evaluacion-del-modelo">
<h2>Evaluación del Modelo<a class="headerlink" href="#evaluacion-del-modelo" title="Enlazar permanentemente con este título">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/rnr_Times_series_Intro-lstm_78_0.png" src="../../_images/rnr_Times_series_Intro-lstm_78_0.png" />
</div>
</div>
<section id="predicciones">
<h3>Predicciones<a class="headerlink" href="#predicciones" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span><span class="n">serie_0_1_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(150, 1)
</pre></div>
</div>
</div>
</div>
</section>
<section id="serie-completa">
<h3>Serie completa<a class="headerlink" href="#serie-completa" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;historia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;valor verdadero&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;predicción&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/rnr_Times_series_Intro-lstm_83_0.png" src="../../_images/rnr_Times_series_Intro-lstm_83_0.png" />
</div>
</div>
</section>
<section id="periodo-de-prueba-test">
<h3>Periodo de prueba (test)<a class="headerlink" href="#periodo-de-prueba-test" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/rnr_Times_series_Intro-lstm_85_0.png" src="../../_images/rnr_Times_series_Intro-lstm_85_0.png" />
</div>
</div>
</section>
</section>
<section id="transforma-a-la-escala-original">
<h2>Transforma a la escala original<a class="headerlink" href="#transforma-a-la-escala-original" title="Enlazar permanentemente con este título">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaled_data</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sine&#39;</span><span class="p">]</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(150, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;verdadero&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;predicción&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/rnr_Times_series_Intro-lstm_91_0.png" src="../../_images/rnr_Times_series_Intro-lstm_91_0.png" />
</div>
</div>
</section>
<section id="span-style-color-blue-modelo-gru-span">
<h2><span style="color:blue">Modelo GRU</span><a class="headerlink" href="#span-style-color-blue-modelo-gru-span" title="Enlazar permanentemente con este título">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># shapes</span>
<span class="n">inputs_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">lstm_output</span> <span class="o">=</span> <span class="mi">60</span>

<span class="c1"># layers</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">inputs_shape</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">GRU</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">lstm_output</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;GRU_layer&#39;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># model</span>
<span class="n">serie_0_1_model_gru</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;series_LSTM_model&#39;</span><span class="p">)</span>


<span class="c1"># summary</span>
<span class="n">serie_0_1_model_gru</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="n">plot_model</span><span class="p">(</span><span class="n">serie_0_1_model_gru</span><span class="p">,</span> <span class="n">to_file</span><span class="o">=</span><span class="s1">&#39;../Imagenes/series_LSTM_model.png&#39;</span><span class="p">,</span> 
           <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model: &quot;series_LSTM_model&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         [(None, 50, 1)]           0         
_________________________________________________________________
GRU_layer (GRU)              (None, 60)                11340     
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 61        
=================================================================
Total params: 11,401
Trainable params: 11,401
Non-trainable params: 0
_________________________________________________________________
</pre></div>
</div>
<img alt="../../_images/rnr_Times_series_Intro-lstm_93_1.png" src="../../_images/rnr_Times_series_Intro-lstm_93_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compila</span>
<span class="n">serie_0_1_model_gru</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">,</span>
  <span class="n">optimizer</span><span class="o">=</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># entrena</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">serie_0_1_model_gru</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/30
43/43 [==============================] - 22s 275ms/step - loss: 0.0159 - val_loss: 0.0030
Epoch 2/30
43/43 [==============================] - 8s 190ms/step - loss: 0.0156 - val_loss: 0.0036
Epoch 3/30
43/43 [==============================] - 9s 208ms/step - loss: 0.0098 - val_loss: 0.0029
Epoch 4/30
43/43 [==============================] - 10s 223ms/step - loss: 0.0059 - val_loss: 0.0024
Epoch 5/30
43/43 [==============================] - 9s 201ms/step - loss: 0.0043 - val_loss: 0.0021
Epoch 6/30
43/43 [==============================] - 8s 185ms/step - loss: 0.0032 - val_loss: 0.0020
Epoch 7/30
43/43 [==============================] - 8s 186ms/step - loss: 0.0024 - val_loss: 0.0020
Epoch 8/30
43/43 [==============================] - 9s 214ms/step - loss: 0.0021 - val_loss: 0.0020
Epoch 9/30
43/43 [==============================] - 7s 170ms/step - loss: 0.0021 - val_loss: 0.0020
Epoch 10/30
43/43 [==============================] - 8s 182ms/step - loss: 0.0021 - val_loss: 0.0020
Epoch 11/30
43/43 [==============================] - 8s 180ms/step - loss: 0.0021 - val_loss: 0.0020
Epoch 12/30
43/43 [==============================] - 7s 161ms/step - loss: 0.0021 - val_loss: 0.0019
Epoch 13/30
43/43 [==============================] - 8s 174ms/step - loss: 0.0021 - val_loss: 0.0019
Epoch 14/30
43/43 [==============================] - 7s 171ms/step - loss: 0.0021 - val_loss: 0.0019
Epoch 15/30
43/43 [==============================] - 8s 178ms/step - loss: 0.0021 - val_loss: 0.0019
Epoch 16/30
43/43 [==============================] - 7s 172ms/step - loss: 0.0021 - val_loss: 0.0019
Epoch 17/30
43/43 [==============================] - 7s 174ms/step - loss: 0.0021 - val_loss: 0.0019
Epoch 18/30
43/43 [==============================] - 8s 182ms/step - loss: 0.0022 - val_loss: 0.0019
Epoch 19/30
43/43 [==============================] - 8s 188ms/step - loss: 0.0022 - val_loss: 0.0019
Epoch 20/30
43/43 [==============================] - 8s 182ms/step - loss: 0.0022 - val_loss: 0.0019
Epoch 21/30
43/43 [==============================] - 8s 185ms/step - loss: 0.0022 - val_loss: 0.0019
Epoch 22/30
43/43 [==============================] - 9s 202ms/step - loss: 0.0022 - val_loss: 0.0019
Epoch 23/30
43/43 [==============================] - 8s 192ms/step - loss: 0.0022 - val_loss: 0.0019
Epoch 24/30
43/43 [==============================] - 9s 201ms/step - loss: 0.0022 - val_loss: 0.0019
Epoch 25/30
43/43 [==============================] - 8s 197ms/step - loss: 0.0022 - val_loss: 0.0019
Epoch 26/30
43/43 [==============================] - 11s 262ms/step - loss: 0.0022 - val_loss: 0.0019
Epoch 27/30
43/43 [==============================] - 9s 202ms/step - loss: 0.0022 - val_loss: 0.0019
Epoch 28/30
43/43 [==============================] - 9s 220ms/step - loss: 0.0021 - val_loss: 0.0019
Epoch 29/30
43/43 [==============================] - 9s 210ms/step - loss: 0.0021 - val_loss: 0.0019
Epoch 30/30
43/43 [==============================] - 9s 211ms/step - loss: 0.0021 - val_loss: 0.0019
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/rnr_Times_series_Intro-lstm_96_0.png" src="../../_images/rnr_Times_series_Intro-lstm_96_0.png" />
</div>
</div>
<section id="id2">
<h3>Predicciones<a class="headerlink" href="#id2" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_gru</span> <span class="o">=</span><span class="n">serie_0_1_model_gru</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># escala original</span>
<span class="n">y_pred_gru</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred_gru</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;prediction lstm&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_gru</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;prediction gru&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/rnr_Times_series_Intro-lstm_99_0.png" src="../../_images/rnr_Times_series_Intro-lstm_99_0.png" />
</div>
</div>
</section>
<section id="numero-de-parametros">
<h3>Número de parámetros<a class="headerlink" href="#numero-de-parametros" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span> <span class="mi">60</span>
<span class="n">n</span><span class="o">=</span><span class="mi">1</span>
<span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span><span class="n">p</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11160
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "AprendizajeProfundo/Libro-Fundamentos",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Redes_Recurrentes\Cuadernos"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="rnr_GRU_Intro.html" title="anterior página">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">anterior</p>
            <p class="prev-next-title"><span style="color:#F72585">Redes GRU (Gated Recurrent Unit)</span></p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Álvaro Mauricio Montenegro Díaz, Daniel Mauricio Montenegro Reyes<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>